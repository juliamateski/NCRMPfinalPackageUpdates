---
title: "Analysis package data export (Julia's Version)"
author: "Julia Mateski"
date: "Feb 2025"
output: html_document
---
```{r}
library(readr)
library(tidyverse)
library(magrittr)
library(ncrmp.benthics.analysis)
library(devtools)
```

```{r}
#user sets working directory
wd = "/Users/juliamateski/Downloads/NCRMPfinalPackageUpdates/"

#check if directory exists, return TRUE if it does exist
dir.exists(wd)

#set working directory for knitting
knitr::opts_knit$set(wd)

#set up project directory
usethis::proj_set(path = wd)

#get current project directory to verify that the project directory is set up correctly
usethis::proj_get()

```

# Load new NTOT files, old strata, calculated from 50m grids
```{r}
# SEFL_2014_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_sefcri2014.csv") %>%
#   dplyr::select(-STAGE_LEVEL)
# SEFL_2016_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_sefcri2016.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# SEFL_2018_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_sefcri2018.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# SEFL_2020_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_sefcri2020.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# SEFL_2022_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_sefcri2022.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# 
# usethis::use_data(SEFL_2014_NTOT,  overwrite = TRUE)
# usethis::use_data(SEFL_2016_NTOT,  overwrite = TRUE)
# usethis::use_data(SEFL_2018_NTOT,  overwrite = TRUE)
# usethis::use_data(SEFL_2020_NTOT,  overwrite = TRUE)
# usethis::use_data(SEFL_2022_NTOT,  overwrite = TRUE)
# 
# FLK_2014_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_fk2014.csv") %>%
#   dplyr::select(-STAGE_LEVEL)
# FLK_2016_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_fk2016.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# FLK_2018_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_fk2018.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# FLK_2020_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_fk2020.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
#FLK_2022_NTOT <- FLK_2020_NTOT
#   dplyr::select(-STAGE_LEVEL)
# 
# usethis::use_data(FLK_2014_NTOT,  overwrite = TRUE)
# usethis::use_data(FLK_2016_NTOT,  overwrite = TRUE)
# usethis::use_data(FLK_2018_NTOT,  overwrite = TRUE)
# usethis::use_data(FLK_2020_NTOT,  overwrite = TRUE)
# usethis::use_data(FLK_2022_NTOT,  overwrite = TRUE)
# Tort_2014_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_dt2014.csv") %>%
#   dplyr::select(-STAGE_LEVEL)
# Tort_2016_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_dt2016.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# Tort_2018_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_dt2018.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# Tort_2020_NTOT <- read.csv("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\NCRMP\\NTOTs\\ntot_dt2020.csv")%>%
#   dplyr::select(-STAGE_LEVEL)
# 
# usethis::
use_data(Tort_2014_NTOT,  overwrite = TRUE)
# usethis::use_data(Tort_2016_NTOT,  overwrite = TRUE)
# usethis::use_data(Tort_2018_NTOT,  overwrite = TRUE)
# usethis::use_data(Tort_2020_NTOT,  overwrite = TRUE)
#usethis::use_data(Tort_2022_NTOT,  overwrite = TRUE)
usethis::use_data(FGBNMS_boundary, overwrite = TRUE)
```

#### Coral Density

```{r}

species_level_metrics <- "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics"
site_level_metrics <- "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics"
strata_level_metrics <- "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics"
domain_est <- "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates"



coral_density <- function(region, project, species_filter = FALSE, start_year, end_year ){
  
  call_data <- NCRMP_DRM_calculate_colony_density(project = project, region = region, species_filter = species_filter)
  
  if(region == "Tortugas"){ region = "Tort"}
  
  if(region == "GOM"){ region = "FGBNMS"}

  prep_csv <- function(dataset_name_string, dataset, location){
    file_name <- paste(project, region, start_year, end_year, dataset_name_string, sep = "_")    
    assign(file_name, value = dataset, envir = .GlobalEnv)
    make_data_path <- paste(paste(location, dataset_name_string, sep = "\\"), "csv", sep = ".")
    write_csv(get(file_name), make_data_path)
    final_data <- get(file_name)
    usethis::use_data(final_data, overwrite = TRUE)
  }
  
  prep_csv("density_species", call_data$density_species, species_level_metrics)  
  prep_csv("density_site", call_data$density_site, site_level_metrics)  
  prep_csv("density_strata", call_data$density_strata, strata_level_metrics)  
  prep_csv("density_region", call_data$Domain_est, domain_est)
}
```

```{r}
coral_density(region = "SEFCRI", project = "NCRMP", species_filter = FALSE, start_year = 2014, end_year =22 )
coral_density(region = "SEFCRI", project = "NCRMP_DRM", species_filter = FALSE, start_year = 2014, end_year =22 )


coral_density(region = "FLK", project = "NCRMP", species_filter = FALSE, start_year = 2014, end_year =22 )
coral_density(region = "FLK", project = "NCRMP_DRM", species_filter = FALSE, start_year = 2014, end_year =22 )


coral_density(region = "Tortugas", project = "NCRMP", species_filter = FALSE, start_year = 2014, end_year =22 )
coral_density(region = "Tortugas", project = "NCRMP_DRM", species_filter = FALSE, start_year = 2014, end_year =22 )
```

```{r}

coral_density(region = "STX", project = "NCRMP", species_filter = FALSE, start_year = 2015, end_year =23 )

coral_density(region = "PRICO", project = "NCRMP", species_filter = FALSE, start_year = 2014, end_year =23 )

coral_density(region = "STTSTJ", project = "NCRMP", species_filter = FALSE, start_year = 2013, end_year =23 )
```

```{r}
coral_density(region = "GOM", project = "NCRMP", species_filter = FALSE, start_year = 2013, end_year =23 )
```
```{r}
NCRMP_DRM_colony_density_CV_and_occurrence <- function(region, ptitle, year, file_path = "NULL", species_filter = "NULL", project){
  #############
  # coral species used in allocation, updated for USVI/PR 2023
  #############
  if (species_filter == TRUE) {
    if(region == "STTSTJ") {
      coral_species <- c("Colpophyllia natans", "Diploria labyrinthiformis", "Madracis decactis", "Meandrina meandrites","Montastraea cavernosa", "Orbicella annularis", "Orbicella faveolata", "Pseudodiploria strigosa", "Siderastrea siderea")
    } else if (region == "STX") {
      coral_species <- c("Colpophyllia natans", "Dichocoenia stokesii", "Madracis decactis", "Montastraea cavernosa", "Orbicella annularis", "Orbicella franksi", "Pseudodiploria strigosa")
    } else if (region == "PRICO") {
      coral_species <- c("Colpophyllia natans", "Diploria labyrinthiformis", "Madracis decactis", "Meandrina meandrites","Montastraea cavernosa", "Orbicella annularis", "Orbicella faveolata", "Orbicella franksi", "Pseudodiploria strigosa")
    } else if (region == "FLK") {
      coral_species <- c("Colpophyllia natans", "Montastraea cavernosa", "Orbicella faveolata", "Porites astreoides", "Siderastrea siderea", "Solenastrea bournoni")
    } else if (region == "Tortugas") {
      coral_species <- c("Colpophyllia natans", "Montastraea cavernosa", "Orbicella faveolata", "Porites astreoides", "Orbicella franksi", "Stephanocoenia intersepta")
    } else if (region == "SEFCRI") {
      coral_species <- c("Acropora cervicornis", "Dichocoenia stokesii", "Montastraea cavernosa", "Porites astreoides", "Pseudodiploria strigosa", "Siderastrea siderea")
    }
  }
  if(region == "FLK" && project == "NCRMP") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_FLK_2014_22_density_species,
                                                        project = project)
  } else if (region == "FLK" && project == "NCRMP_DRM") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_DRM_FLK_2014_22_density_species,
                                                        project = project)
  } else if (region == "FLK" && project == "MIR") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = MIR_2022_density_species_DUMMY,
                                                        project = project)
  } else if (region == "Tortugas" && project == "NCRMP") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_Tort_2014_22_density_species,
                                                        project = project)
  } else if (region == "Tortugas" && project == "NCRMP_DRM") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_DRM_Tort_2014_22_density_species,
                                                        project = project)
  } else if (region == "SEFCRI" && project == "NCRMP") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_SEFCRI_2014_22_density_species,
                                                        project = project)
  } else if (region == "SEFCRI" && project == "NCRMP_DRM") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_DRM_SEFCRI_2014_22_density_species,
                                                        project = project)
  } else if (region == "PRICO") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_PRICO_2014_23_density_species,
                                                        project = project)
  } else if (region == "STTSTJ") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_STTSTJ_2013_23_density_species,
                                                        project = project)
  } else if (region == "STX") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_STX_2015_23_density_species,
                                                        project = project)
  } else if (region == "GOM") {
    region_means <- NCRMP_make_weighted_density_CV_data(region = region,
                                                        sppdens = NCRMP_FGBNMS_2013_24_density_species,
                                                        project = project)
  }
  if (species_filter == TRUE) {
    region_means <- region_means %>% dplyr::filter(SPECIES_CD %in% coral_species)
  }
  if(region == "STX" || region == "STTSTJ" || region == "PRICO" || region == "GOM") {
    # Create plot pieces to export
    g.mid <- region_means %>%
      # filter to year of interest
      dplyr::filter(YEAR == year) %>%
      # exclude occurrences of 0
      dplyr::filter(occurrence > 0.011) %>%
      # exclude CVs over 1
      dplyr::filter(CV < 1) %>%
      # plot
      ggplot(.,
             aes(x = 1,
                 y = reorder(SPECIES_CD, occurrence)))+
      geom_text(aes(label = SPECIES_CD),
                size = 3,
                fontface = "italic") +
      geom_segment(aes(x = 0.94,
                       xend = 0.96,
                       yend = SPECIES_CD))+
      geom_segment(aes(x = 1.04,
                       xend = 1.065,
                       yend = SPECIES_CD))+
      ggtitle(ptitle) +
      ylab(NULL) +
      scale_x_continuous(expand = c(0,0),
                         limits = c(0.94, 1.065))+
      theme(axis.title = element_blank(),
            panel.grid = element_blank(),
            axis.text.y = element_blank(),
            axis.ticks.y = element_blank(),
            panel.background = element_blank(),
            axis.text.x = element_text(color = NA),
            axis.ticks.x = element_line(color = NA),
            plot.margin = unit(c(t = 1, r = -1, b = 1, l = -1), "mm"),
            plot.title = element_text(hjust = 0.5))
    g1 <-  region_means %>%
      # filter to year of interest
      dplyr::filter(YEAR == year) %>%
      # exclude occurrences of 0
      dplyr::filter(occurrence > 0.01) %>%
      # exclude CVs over 1
      dplyr::filter(CV < 1) %>%
      ggplot(.,
             aes(x = reorder(SPECIES_CD, occurrence),
                 y = occurrence,
                 fill = 'even')) +
      # geom_hline(yintercept = c(0.25, 0.5, 0.75),
      # colour = "light grey") +
      geom_bar(stat = "identity",
               fill = "deepskyblue4") +
      ggtitle(paste("Species", "occurrence", sep = " ")) +
      # scale_fill_manual(values = c( "#0a4595")) +
      theme_light() +
      scale_y_continuous(expand = c(0,0)) +
      theme(axis.title.x = element_blank(),
            axis.title.y = element_blank(),
            axis.text.y = element_blank(),
            axis.ticks.y = element_blank(),
            plot.margin = unit(c(t = 1, r = -0.5, b = 1, l = 1), "mm"),
            plot.title = element_text(hjust = 0.5,
                                      size = 10,
                                      face = "bold")) +
      coord_flip() +
      scale_y_reverse(expand = c(NA,0)) +
      # scale_y_reverse(breaks = c(0, 0.25, 0.5, 0.75)) +
      guides(fill = "none")
    g2 <- region_means %>%
      # filter to year of interest
      dplyr::filter(YEAR == year) %>%
      # exclude occurrences of 0
      dplyr::filter(occurrence > 0.01) %>%
      # exclude CVs over 1
      dplyr::filter(CV < 1) %>%
      ggplot(data = .,
             aes(x = reorder(SPECIES_CD, occurrence),
                 y = CV*100,
                 fill = 'even')) +
      xlab(NULL) +
      geom_bar(stat = "identity",
               fill = "deepskyblue4") +
      ggtitle("Coefficient of Variation (CV) of density") +
      theme_light() +
      scale_y_continuous(expand = c(0,0)) +
      theme(axis.title.x = element_blank(),
            axis.title.y = element_blank(),
            axis.text.y = element_blank(),
            axis.ticks.y = element_blank(),
            plot.margin = unit(c(t = 1, r = 1, b = 1, l = -2), "mm"),
            plot.title = element_text(hjust = 0.5,
                                      size = 10,
                                      face = "bold")) +
      coord_flip() +
      guides(fill = "none") +
      geom_hline(yintercept=20, linetype="dashed", color = "black")
    # scale_fill_manual(values= c( "#58babb"))
  } else {
    # Create plot pieces to export
    g.mid <- region_means %>%
      # filter to year of interest
      dplyr::filter(YEAR == year) %>%
      # exclude occurrences of 0
      dplyr::filter(occurrence > 0.02) %>%
      # exclude CVs over 1
      dplyr::filter(CV < 1) %>%
      # plot
      ggplot(.,
             aes(x = 1,
                 y = reorder(SPECIES_CD, occurrence)))+
      geom_text(aes(label = SPECIES_CD),
                size = 4,
                fontface = "italic") +
      geom_segment(aes(x = 0.94,
                       xend = 0.96,
                       yend = SPECIES_CD))+
      geom_segment(aes(x = 1.04,
                       xend = 1.065,
                       yend = SPECIES_CD))+
      ggtitle(ptitle) +
      ylab(NULL) +
      scale_x_continuous(expand = c(0,0),
                         limits = c(0.94, 1.065))+
      theme(axis.title = element_blank(),
            panel.grid = element_blank(),
            axis.text.y = element_blank(),
            axis.ticks.y = element_blank(),
            panel.background = element_blank(),
            axis.text.x = element_text(color = NA),
            axis.ticks.x = element_line(color = NA),
            plot.margin = unit(c(t = 1, r = -1, b = 1, l = -1), "mm"),
            plot.title = element_text(hjust = 0.5))
    g1 <-  region_means %>%
      # filter to year of interest
      dplyr::filter(YEAR == year) %>%
      # exclude occurrences of 0
      dplyr::filter(occurrence > 0.01) %>%
      # exclude CVs over 1
      dplyr::filter(CV < 1) %>%
      ggplot(.,
             aes(x = reorder(SPECIES_CD, occurrence),
                 y = occurrence,
                 fill = 'even')) +
      # geom_hline(yintercept = c(0.25, 0.5, 0.75),
      # colour = "light grey") +
      geom_bar(stat = "identity",
               fill = "deepskyblue4") +
      ggtitle(paste("Species", "occurrence", sep = " ")) +
      # scale_fill_manual(values = c( "#0a4595")) +
      theme_light() +
      scale_y_continuous(expand = c(0,0)) +
      theme(axis.title.x = element_blank(),
            axis.title.y = element_blank(),
            axis.text.y = element_blank(),
            axis.ticks.y = element_blank(),
            plot.margin = unit(c(t = 1, r = -0.5, b = 1, l = 1), "mm"),
            plot.title = element_text(hjust = 0.5,
                                      size = 12,
                                      face = "bold")) +
      coord_flip() +
      scale_y_reverse(expand = c(NA,0)) +
      # scale_y_reverse(breaks = c(0, 0.25, 0.5, 0.75)) +
      guides(fill = "none")
    g2 <- region_means %>%
      # filter to year of interest
      dplyr::filter(YEAR == year) %>%
      # exclude occurrences of 0
      dplyr::filter(occurrence > 0.02) %>%
      # exclude CVs over 1
      dplyr::filter(CV < 1) %>%
      ggplot(data = .,
             aes(x = reorder(SPECIES_CD, occurrence),
                 y = CV*100,
                 fill = 'even')) +
      xlab(NULL) +
      geom_bar(stat = "identity",
               fill = "deepskyblue4") +
      ggtitle("Coefficient of Variation (CV) of density") +
      theme_light() +
      scale_y_continuous(expand = c(0,0)) +
      theme(axis.title.x = element_blank(),
            axis.title.y = element_blank(),
            axis.text.y = element_blank(),
            axis.ticks.y = element_blank(),
            plot.margin = unit(c(t = 1, r = 1, b = 1, l = -2), "mm"),
            plot.title = element_text(hjust = 0.5,
                                      size = 12,
                                      face = "bold")) +
      coord_flip() +
      guides(fill = "none") +
      geom_hline(yintercept=20, linetype="dashed", color = "black")
    # scale_fill_manual(values= c( "#58babb"))
  }
  cowplot::plot_grid(g1,
                     g.mid,
                     g2,
                     ncol = 3
                     # rel_widths = c(1, 0.5)
  )
  if(project == "NCRMP_DRM"){
    ggsave(filename = paste(region_means$REGION[1], "Occ_v_CV_NCRMP_DRM.jpeg", sep = "_"),
           path = file_path,
           plot = gridExtra::grid.arrange(g1, g.mid, g2,
                                          ncol = 3,
                                          widths = c(3.5/9,2/9,3.5/9)),
           width = 9.8,
           height = 6.5,
           dpi = 300,
           units = "in",
           device = "jpg")
  } else{
    ggsave(filename = paste(region_means$REGION[1], "Occ_v_CV.jpeg", sep = "_"),
           path = file_path,
           plot = gridExtra::grid.arrange(g1, g.mid, g2,
                                          ncol = 3,
                                          widths = c(3.5/9,2/9,3.5/9)),
           width = 9.8,
           height = 6.5,
           dpi = 300,
           units = "in",
           device = "jpg")
  }
  region_means_cv20 <- region_means %>%
    dplyr::filter(CV <= .20)
  ################
  # Export
  ################
  # Create list to export
  output <- list(
    "region_means" = region_means,
    "region_means_cv20" = region_means_cv20)
  return(output)
}
```


##### Density CV and occurrence 

```{r}

fig_path <- "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures"
CV_path <- "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV"


density_CV_and_occ <- function(region_code, region_name, project, year){
  
  density_data <- NCRMP_DRM_colony_density_CV_and_occurrence(region = region_code,
                                              ptitle = region_name,
                                              project = project,
                                              year = year,
                                              file_path = fig_path,  
                                              species_filter = "NULL")

save_file_dens_occ_cv <- function(file_name, data){
  assign(file_name, value = data, envir = .GlobalEnv)
  make_data_path <- paste(paste(CV_path, file_name, sep = "\\"), "csv", sep = ".")
  write_csv(get(file_name), make_data_path)
  final_data <- get(file_name)
  usethis::use_data(final_data, overwrite = TRUE)
}

region_means_file_name <- paste(project, region_code, "Occ_Den_CV", sep = "_")  
save_file_dens_occ_cv(region_means_file_name, density_data$region_means)

region_means_20_file_name <- paste(project, region_code, "Occ_Den_CV", 20, sep = "_")  
save_file_dens_occ_cv(region_means_20_file_name, density_data$region_means_cv20)
  
}

density_CV_and_occ(region_code = "FLK", region_name = "Florida Keys", project = "NCRMP", year = 2022)

```



###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_SEFCRI_2014_22_density_region,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    test_type = "Years",
                    n_years = 4, # this needs to be updated in conjunction with updating the t test function to accommodate more years
                    return_dataframe = FALSE)
```
##### Density CV and occurrence 

```{r}
output1 <- NCRMP_DRM_SEFCRI_Occ_Den_CV_1
output2 <- NCRMP_DRM_SEFCRI_Occ_Den_CV

# Compare outputs
identical(output1, output2)  # Checks if they are exactly the same

# If there might be minor differences (e.g., numerical precision)
all.equal(output1, output2, tolerance = 1e-10)
  # Returns TRUE if they are nearly identical, or a description of differences

```
##### Density CV and occurrence - NCRMP + DRM  
`


```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "FLK",
                                              ptitle = "Florida Keys",
                                              year = 2022,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "NCRMP")
NCRMP_FLK_Occ_Den_CV_1 <- tmp$region_means
NCRMP_FLK_Occ_Den_CV_20_1 <- tmp$region_means_cv20
write.csv(NCRMP_FLK_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_FLK_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_FLK_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_FLK_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_Occ_Den_CV_20,  overwrite = TRUE)
```






##### Species richness - NCRMP only
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "SEFCRI")
NCRMP_SEFCRI_2014_22_spp_list <- tmp$species_list 
NCRMP_SEFCRI_2014_22_richness_site <- tmp$richness_site
NCRMP_SEFCRI_2014_22_richness_strata <- tmp$richness_strata
NCRMP_SEFCRI_2014_22_richness_region <- tmp$Domain_est
NCRMP_SEFCRI_2014_22_diversity_site <- tmp$species_diversity_site
NCRMP_SEFCRI_2014_22_diversity_strata <- tmp$diversity_strata
NCRMP_SEFCRI_2014_22_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_SEFCRI_2014_22_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_richness_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_richness_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_SEFCRI_2014_22_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_SEFCRI_2014_22_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_diversity_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_diversity_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_SEFCRI_2014_22_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### DRM Species richness - NCRMP + DRM 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP_DRM",
                                                       region = "SEFCRI")
NCRMP_DRM_SEFCRI_2014_22_spp_list <- tmp$species_list 
NCRMP_DRM_SEFCRI_2014_22_richness_site <- tmp$richness_site
NCRMP_DRM_SEFCRI_2014_22_richness_strata <- tmp$richness_strata
NCRMP_DRM_SEFCRI_2014_22_richness_region <- tmp$Domain_est
NCRMP_DRM_SEFCRI_2014_22_diversity_site <- tmp$species_diversity_site
NCRMP_DRM_SEFCRI_2014_22_diversity_strata <- tmp$diversity_strata
NCRMP_DRM_SEFCRI_2014_22_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_DRM_SEFCRI_2014_22_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_22_richness_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_22_richness_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_DRM_SEFCRI_2014_22_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_22_diversity_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_22_diversity_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### Percent cover
###### Region 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_cover(region = "SEFCRI", project = "NCRMP")
NCRMP_SEFCRI_2014_22_percent_cover_species <- tmp$percent_cover_species
NCRMP_SEFCRI_2014_22_percent_cover_site <- tmp$percent_cover_site
NCRMP_SEFCRI_2014_22_cover_group_key <- tmp$cover_group_key
NCRMP_SEFCRI_2014_22_cover_strata <- tmp$cover_strata
NCRMP_SEFCRI_2014_22_cover_region <- tmp$Domain_est
NCRMP_SEFCRI_2014_22_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations # from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(NCRMP_SEFCRI_2014_22_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_SEFCRI_2014_22_percent_cover_species.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_percent_cover_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_cover_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_cover_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_SEFCRI_2014_22_percent_cover_species,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_percent_cover_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_cover_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_cover_region,  overwrite = TRUE)
```
###### Species
```{r}
# Run function and assign names to dataframes 
tmp <-NCRMP_colony_percent_cover(region = "SEFCRI",
                                 ptitle = "Southeast Florida",
                                 file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" )
NCRMP_SEFCRI_2014_22_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(NCRMP_SEFCRI_2014_22_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_percent_cover_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_SEFCRI_2014_22_percent_cover_region_species,  overwrite = TRUE)
```
###### Percent cover t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_SEFCRI_2014_22_cover_region,
                    metric1 = 'coral_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    test_type = "Years",
                    n_years = 4,
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_SEFCRI_2014_22_cover_region,
                    metric1 = 'macroalgae_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    test_type = "Years",
                    n_years = 4,
                    return_dataframe = FALSE)
```
##### Mortality - NCRMP only
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP",
                                     region = "SEFCRI",
                                     species_filter = "FALSE")
# ntot check - checks NTOT weighting for species-region mortality
# wh_sum should always = 1 (sum of all the weights for a single species in a single year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
NCRMP_SEFCRI_2014_22_old_mort_site <- tmp$old_mortality_site
NCRMP_SEFCRI_2014_22_rec_mort_site <- tmp$recent_mortality_site
NCRMP_SEFCRI_2014_22_old_mort_strata <- tmp$old_mortality_strata
NCRMP_SEFCRI_2014_22_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_SEFCRI_2014_22_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_SEFCRI_2014_22_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_SEFCRI_2014_22_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_SEFCRI_2014_22_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# Export data 
write.csv(NCRMP_SEFCRI_2014_22_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_old_mort_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_14_22_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_old_mort_region.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_rec_mort_species_region.csv", row.names = F)
usethis::use_data(NCRMP_SEFCRI_2014_22_rec_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_old_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_old_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_rec_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_old_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_old_mort_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_rec_mort_species_region,  overwrite = TRUE)
```
##### DRM Mortality - NCRMP + DRM
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP_DRM",
                                     region = "SEFCRI",
                                     species_filter = "FALSE")
# ntot check - checks NTOT weighting for species-region mortality
# wh_sum should always = 1 (sum of all the weights for a single species in a single year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
NCRMP_DRM_SEFCRI_2014_22_old_mort_site <- tmp$old_mortality_site
NCRMP_DRM_SEFCRI_2014_22_rec_mort_site <- tmp$recent_mortality_site
NCRMP_DRM_SEFCRI_2014_22_old_mort_strata <- tmp$old_mortality_strata
NCRMP_DRM_SEFCRI_2014_22_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_DRM_SEFCRI_2014_22_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_DRM_SEFCRI_2014_22_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_DRM_SEFCRI_2014_22_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_DRM_SEFCRI_2014_22_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# Export data 
write.csv(NCRMP_DRM_SEFCRI_2014_22_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_22_old_mort_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_SEFCRI_14_22_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_22_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_22_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_old_mort_region.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_rec_mort_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_rec_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_old_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_old_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_rec_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_old_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_old_mort_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_rec_mort_species_region,  overwrite = TRUE)
```
##### Disease and bleaching - NCRMP only
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP",
                                                       region = "SEFCRI",
                                                       species_filter = "FALSE")
NCRMP_SEFCRI_2014_22_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_SEFCRI_2014_22_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_SEFCRI_2014_22_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_SEFCRI_2014_22_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_SEFCRI_2014_22_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_SEFCRI_2014_22_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_SEFCRI_2014_22_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_dis_ble_prev_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_ble_prev_species,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_ble_prev_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_ble_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_ble_prev_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP",
                                                             region = "SEFCRI")
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
NCRMP_SEFCRI_2014_22_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_SEFCRI_2014_22_ble_prev_species_region <- tmp$DomainEst_bl
write.csv(NCRMP_SEFCRI_2014_22_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_ble_prev_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_prev_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_ble_prev_species_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP",
                                                    region = "SEFCRI",
                                                    species_filter = "FALSE")
NCRMP_SEFCRI_2014_22_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_SEFCRI_2014_22_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_SEFCRI_2014_22_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_SEFCRI_2014_22_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_dis_ble_n_sites_per_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_ble_PA_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_n_sites_per_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_dis_ble_n_sites_per_region,  overwrite = TRUE)
```
##### DRM Disease prevalence - NCRMP + DRM 
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP_DRM",
                                                       region = "SEFCRI",
                                                       species_filter = "FALSE")
NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_DRM_SEFCRI_2014_22_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_DRM_SEFCRI_2014_22_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_22_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_22_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_region, overwrite = T)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_ble_prev_strata, overwrite = T)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_prev_strata, overwrite = T)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_site, overwrite = T)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_ble_prev_species, overwrite = T)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP_DRM",
                                                             region = "SEFCRI")
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
NCRMP_DRM_SEFCRI_2014_22_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_DRM_SEFCRI_2014_22_ble_prev_species_region <- tmp$DomainEst_bl
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_ble_prev_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_prev_species_region, overwrite = T)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_ble_prev_species_region, overwrite = T)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP_DRM",
                                                    region = "SEFCRI",
                                                    species_filter = "FALSE")
NCRMP_DRM_SEFCRI_2014_22_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_DRM_SEFCRI_2014_22_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_DRM_SEFCRI_2014_22_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_22_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_22_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_22_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_dis_ble_n_sites_per_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_ble_PA_site, overwrite = T)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_n_sites_per_strata, overwrite = T)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_dis_ble_n_sites_per_region, overwrite = T)
```
##### Colony size - NCRMP only  
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP",
                                            region = "SEFCRI",
                                            species_filter = "FALSE")
NCRMP_SEFCRI_2014_22_col_size_species <- tmp$size_species
NCRMP_SEFCRI_2014_22_col_size_site <- tmp$size_site
NCRMP_SEFCRI_2014_22_col_size_cm2_strata <- tmp$size_est_cm2_strata
NCRMP_SEFCRI_2014_22_col_size_cm3_strata <- tmp$size_est_cm3_strata
NCRMP_SEFCRI_2014_22_col_size_region <- tmp$Domain_est
NCRMP_SEFCRI_2014_22_col_size_region_species <- tmp$Domain_est_species
# species-specific ntot check
unique(tmp$ntot_check_species$wh_sum)
# Export data
write.csv(NCRMP_SEFCRI_2014_22_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_col_size_species.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_SEFCRI_2014_22_col_size_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_col_size_cm2_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_SEFCRI_2014_22_col_size_cm3_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_col_size_region.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_SEFCRI_2014_22_col_size_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_SEFCRI_2014_22_col_size_species,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_col_size_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_col_size_cm2_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_col_size_cm3_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_col_size_region,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_col_size_region_species,  overwrite = TRUE)
```
##### Colony size - NCRMP + DRM  
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP_DRM",
                                            region = "SEFCRI",
                                            species_filter = "FALSE")
NCRMP_DRM_SEFCRI_2014_22_col_size_region_species <- tmp$Domain_est_species
# species-specific ntot check
unique(tmp$ntot_check_species$wh_sum)
write.csv(NCRMP_DRM_SEFCRI_2014_22_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_22_col_size_region_species.csv", row.names = F)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_22_col_size_region_species,  overwrite = TRUE)
```
##### Diadema density
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "SEFCRI")
NCRMP_SEFCRI_2014_22_invert_den_site <- tmp$diadema_density_site
NCRMP_SEFCRI_2014_22_invert_den_strata <- tmp$invert_strata # Right now just diadema
NCRMP_SEFCRI_2014_22_invert_den_region <- tmp$Domain_est
# Export data 
write.csv(NCRMP_SEFCRI_2014_22_invert_den_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_SEFCRI_2014_22_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_invert_den_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_SEFCRI_2014_22_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_22_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_SEFCRI_2014_22_invert_den_region.csv", row.names = F)
# copy to conole and run
usethis::use_data(NCRMP_SEFCRI_2014_22_invert_den_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_invert_den_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_22_invert_den_region,  overwrite = TRUE)
```

###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_FLK_2014_22_density_region,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    test_type = "Years",
                    n_years = 4, # this needs to be updated in conjunction with updating the t test function to accommodate more years
                    return_dataframe = FALSE)
```
##### Density CV and occurrence - NCRMP only  
```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "FLK",
                                              ptitle = "Florida Keys",
                                              year = 2022,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "NCRMP")
NCRMP_FLK_Occ_Den_CV <- tmp$region_means
NCRMP_FLK_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_FLK_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_FLK_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_FLK_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_FLK_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_Occ_Den_CV_20,  overwrite = TRUE)
```

##### Density CV and occurrence - NCRMP + DRM  
```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "FLK",
                                              ptitle = "Florida Keys",
                                              year = 2022,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures/NCRMP_DRM" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "NCRMP_DRM")
NCRMP_DRM_FLK_Occ_Den_CV <- tmp$region_means
NCRMP_DRM_FLK_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_DRM_FLK_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_DRM_FLK_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_DRM_FLK_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_FLK_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_Occ_Den_CV_20,  overwrite = TRUE)
```
##### Species richness - NCRMP only
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "FLK")
NCRMP_FLK_2014_22_spp_list <- tmp$species_list 
NCRMP_FLK_2014_22_richness_site <- tmp$richness_site
NCRMP_FLK_2014_22_richness_strata <- tmp$richness_strata
NCRMP_FLK_2014_22_richness_region <- tmp$Domain_est
NCRMP_FLK_2014_22_diversity_site <- tmp$species_diversity_site
NCRMP_FLK_2014_22_diversity_strata <- tmp$diversity_strata
NCRMP_FLK_2014_22_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_FLK_2014_22_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_richness_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_richness_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_richness_region.csv", row.names = F)
# Diversity
write.csv(NCRMP_FLK_2014_22_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_diversity_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_diversity_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_diversity_region.csv", row.names = F)
# copy to console to export
usethis::use_data(NCRMP_FLK_2014_22_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_diversity_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_richness_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### DRM Species richness - NCRMP + DRM 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP_DRM",
                                                       region = "FLK")
NCRMP_DRM_FLK_2014_22_spp_list <- tmp$species_list 
NCRMP_DRM_FLK_2014_22_richness_site <- tmp$richness_site
NCRMP_DRM_FLK_2014_22_richness_strata <- tmp$richness_strata
NCRMP_DRM_FLK_2014_22_richness_region <- tmp$Domain_est
NCRMP_DRM_FLK_2014_22_diversity_site <- tmp$species_diversity_site
NCRMP_DRM_FLK_2014_22_diversity_strata <- tmp$diversity_strata
NCRMP_DRM_FLK_2014_22_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_DRM_FLK_2014_22_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_FLK_2014_22_richness_site.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_FLK_2014_22_richness_strata.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_richness_region.csv", row.names = F)
# Diversity
write.csv(NCRMP_DRM_FLK_2014_22_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_FLK_2014_22_diversity_site.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_FLK_2014_22_diversity_strata.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_diversity_region.csv", row.names = F)
# copy to console to export
usethis::use_data(NCRMP_DRM_FLK_2014_22_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_diversity_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_richness_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### Percent cover
###### Region 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_cover(region = "FLK", project = "NCRMP")
#tmp_flk <- tmp
NCRMP_FLK_2014_22_percent_cover_species <- tmp$percent_cover_species
NCRMP_FLK_2014_22_percent_cover_site <- tmp$percent_cover_site
NCRMP_FLK_2014_22_cover_group_key <- tmp$cover_group_key
NCRMP_FLK_2014_22_cover_strata <- tmp$cover_strata
NCRMP_FLK_2014_22_cover_region <- tmp$Domain_est
NCRMP_FLK_2014_22_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site # this will always be off for some 2014 sites - transects 1 and 2 were given different habitats. 
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(NCRMP_FLK_2014_22_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_FLK_2014_22_percent_cover_species.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_percent_cover_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_cover_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_cover_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_percent_cover_species,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_percent_cover_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_cover_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_cover_region,  overwrite = TRUE)
```
###### Species
```{r}
# Run function and assign names to dataframes 
tmp <-NCRMP_colony_percent_cover(region = "FLK",
                                 ptitle = "The Florida Keys",
                                 file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" )
NCRMP_FLK_2014_22_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(NCRMP_FLK_2014_22_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_percent_cover_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_percent_cover_region_species,  overwrite = TRUE)
```
##### Mortality - NCRMP only
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP",
                                     region = "FLK",
                                     species_filter = "FALSE")
NCRMP_FLK_2014_22_old_mort_site <- tmp$old_mortality_site
NCRMP_FLK_2014_22_rec_mort_site <- tmp$recent_mortality_site
NCRMP_FLK_2014_22_old_mort_strata <- tmp$old_mortality_strata
NCRMP_FLK_2014_22_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_FLK_2014_22_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_FLK_2014_22_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_FLK_2014_22_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_FLK_2014_22_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_FLK_2014_22_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_old_mort_site.csv", row.names = F) 
write.csv(NCRMP_FLK_2014_22_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_14_22_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_old_mort_region.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_rec_mort_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_rec_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_old_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_old_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_rec_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_old_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_old_mort_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_rec_mort_species_region,  overwrite = TRUE)
```
##### DRM Mortality - NCRMP + DRM 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP_DRM",
                                     region = "FLK",
                                     species_filter = "FALSE")
NCRMP_DRM_FLK_2014_22_old_mort_site <- tmp$old_mortality_site
NCRMP_DRM_FLK_2014_22_rec_mort_site <- tmp$recent_mortality_site
NCRMP_DRM_FLK_2014_22_old_mort_strata <- tmp$old_mortality_strata
NCRMP_DRM_FLK_2014_22_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_DRM_FLK_2014_22_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_DRM_FLK_2014_22_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_DRM_FLK_2014_22_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_DRM_FLK_2014_22_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_DRM_FLK_2014_22_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_FLK_2014_22_old_mort_site.csv", row.names = F) 
write.csv(NCRMP_DRM_FLK_2014_22_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_FLK_2014_22_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_FLK_2014_22_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_FLK_2014_22_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_old_mort_region.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_rec_mort_species_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_FLK_2014_22_rec_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_old_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_old_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_rec_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_old_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_old_mort_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_rec_mort_species_region,  overwrite = TRUE)
```
##### Disease and bleaching - NCRMP only
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP",
                                                       region = "FLK",
                                                       species_filter = "FALSE")
NCRMP_FLK_2014_22_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_FLK_2014_22_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_FLK_2014_22_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_FLK_2014_22_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_FLK_2014_22_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_FLK_2014_22_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_dis_ble_prev_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_dis_ble_prev_species,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_dis_ble_prev_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_ble_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_dis_ble_prev_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP",
                                                             region = "FLK")
NCRMP_FLK_2014_22_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_FLK_2014_22_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_FLK_2014_22_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_ble_prev_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_dis_prev_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_ble_prev_species_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP",
                                                    region = "FLK",
                                                    species_filter = "FALSE")
NCRMP_FLK_2014_22_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_FLK_2014_22_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_FLK_2014_22_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_FLK_2014_22_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_dis_ble_n_sites_per_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_dis_ble_PA_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_dis_n_sites_per_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_dis_ble_n_sites_per_region,  overwrite = TRUE)
```
##### DRM Disease prevalence - NCRMP + DRM 
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP_DRM",
                                                       region = "FLK",
                                                       species_filter = "FALSE")
NCRMP_DRM_FLK_2014_22_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_DRM_FLK_2014_22_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_DRM_FLK_2014_22_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_DRM_FLK_2014_22_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_DRM_FLK_2014_22_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_DRM_FLK_2014_22_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_DRM_FLK_2014_22_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_FLK_2014_22_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_FLK_2014_22_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_FLK_2014_22_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_dis_ble_prev_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_ble_prev_species,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_dis_ble_prev_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_ble_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_dis_ble_prev_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP_DRM",
                                                             region = "FLK")
NCRMP_DRM_FLK_2014_22_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_DRM_FLK_2014_22_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_DRM_FLK_2014_22_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_ble_prev_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_FLK_2014_22_dis_prev_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_ble_prev_species_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP_DRM",
                                                    region = "FLK",
                                                    species_filter = "FALSE")
NCRMP_DRM_FLK_2014_22_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_DRM_FLK_2014_22_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_DRM_FLK_2014_22_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_DRM_FLK_2014_22_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_FLK_2014_22_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_FLK_2014_22_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_DRM_FLK_2014_22_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_dis_ble_n_sites_per_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_FLK_2014_22_dis_ble_PA_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_dis_n_sites_per_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_FLK_2014_22_dis_ble_n_sites_per_region,  overwrite = TRUE)
```
##### Colony size - NCRMP only  
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP",
                                            region = "FLK",
                                            species_filter = "FALSE")
NCRMP_FLK_2014_22_col_size_species <- tmp$size_species
NCRMP_FLK_2014_22_col_size_site <- tmp$size_site
NCRMP_FLK_2014_22_col_size_cm2_strata <- tmp$size_est_cm2_strata
NCRMP_FLK_2014_22_col_size_cm3_strata <- tmp$size_est_cm3_strata
NCRMP_FLK_2014_22_col_size_region <- tmp$Domain_est
NCRMP_FLK_2014_22_col_size_region_species <- tmp$Domain_est_species
# species-specific ntot check
unique(tmp$ntot_check_species$wh_sum)
# Export data
write.csv(NCRMP_FLK_2014_22_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_col_size_species.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_2014_22_col_size_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_col_size_cm2_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FLK_2014_22_col_size_cm3_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_col_size_region.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FLK_2014_22_col_size_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_col_size_species,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_col_size_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_col_size_cm2_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_col_size_cm3_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_col_size_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_col_size_region_species,  overwrite = TRUE)
```
##### Colony size - NCRMP + DRM 
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP_DRM",
                                            region = "FLK",
                                            species_filter = "FALSE")
NCRMP_DRM_FLK_2014_22_col_size_region_species <- tmp$Domain_est_species
# species-specific ntot check
unique(tmp$ntot_check_species$wh_sum)
write.csv(NCRMP_DRM_FLK_2014_22_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_FLK_2014_22_col_size_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_FLK_2014_22_col_size_region_species,  overwrite = TRUE)
```
##### Diadema density  
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "FLK", project = "NCRMP")
NCRMP_FLK_2014_22_invert_den_site <- tmp$diadema_density_site
NCRMP_FLK_2014_22_invert_den_strata <- tmp$invert_strata # Right now just diadema
NCRMP_FLK_2014_22_invert_den_region <- tmp$Domain_est
# Export data 
write.csv(NCRMP_FLK_2014_22_invert_den_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_FLK_2014_22_invert_den_site.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_invert_den_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_FLK_2014_22_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_FLK_2014_22_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_FLK_2014_22_invert_den_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FLK_2014_22_invert_den_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_invert_den_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FLK_2014_22_invert_den_region,  overwrite = TRUE)
# Don't forget to delete the previous years output in the R package and in the Data Queries folder 
```
### FLK - MIR
##### Coral density 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_colony_density(project = "MIR", 
                                          region = "FLK",
                                          species_filter = "FALSE")
MIR_2022_density_species_DUMMY <- tmp$density_species
MIR_2022_density_site_DUMMY <- tmp$density_site
MIR_2022_density_strata_DUMMY <- tmp$density_strata
MIR_2022_density_region_DUMMY <- tmp$Domain_est
MIR_2022_density_PROT_DUMMY <- tmp$Domain_est_PROT
# Export data 
# write.csv(MIR_2022_density_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\MIR_2022_density_species.csv", row.names = F)
# 
# write.csv(MIR_2022_density_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_density_site.csv", row.names = F)
# 
# write.csv(MIR_2022_density_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_density_strata.csv", row.names = F)
# 
# write.csv(MIR_2022_density_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_density_region.csv", row.names = F)
# These lines need to be run in the console, not the code chunk
usethis::use_data(MIR_2022_density_species_DUMMY,  overwrite = TRUE)
usethis::use_data(MIR_2022_density_site_DUMMY,  overwrite = TRUE)
usethis::use_data(MIR_2022_density_strata_DUMMY,  overwrite = TRUE)
usethis::use_data(MIR_2022_density_region_DUMMY,  overwrite = TRUE)
```
###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = MIR_2022_density_PROT_DUMMY,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    test_type = "PROT",
                    return_dataframe = FALSE)
# The output for this is printing PROT = 1 and 2 rather than 0 and 1 (maybe it is printing the row name and not the value?) but the test is correct and maybe if you are reading this you can fix the problem. It prints correctly when I run it manually in the function. 
```
##### Density CV and occurrence 
```{r}
tmp <- NCRMP_colony_density_CV_and_occurrence(region = "FLK",
                                              ptitle = "MIR - Florida Keys - DUMMY",
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "MIR")
MIR_FLK_Occ_Den_CV_DUMMY <- tmp$region_means
MIR_FLK_Occ_Den_CV_20_DUMMY <- tmp$region_means_cv20
# write.csv(MIR_FLK_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\MIR_FLK_Occ_Den_CV.csv", row.names = F)
# write.csv(MIR_FLK_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\MIR_FLK_Occ_Den_CV_20.csv", row.names = F)
usethis::use_data(MIR_FLK_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(MIR_FLK_Occ_Den_CV_20,  overwrite = TRUE)
```
##### Percent cover
###### Region 
```{r}
# Run function and assign names to data frames 
tmp <- NCRMP_calculate_cover(region = "FLK", project = "MIR")
MIR_2022_percent_cover_species_DUMMY <- tmp$percent_cover_species
MIR_2022_percent_cover_site <- tmp$percent_cover_site
MIR_2022_cover_group_key <- tmp$cover_group_key
MIR_2022_cover_strata <- tmp$cover_strata
MIR_2022_cover_region <- tmp$Domain_est
MIR_2022_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site # Make sure each sites has total percent cover of 100%; this will always be off for some 2014 sites - transects 1 and 2 were given different habitats. 
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(MIR_2022_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\MIR_2022_percent_cover_species.csv", row.names = F)
write.csv(MIR_2022_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_percent_cover_site.csv", row.names = F)
write.csv(MIR_2022_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_cover_strata.csv", row.names = F)
write.csv(MIR_2022_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_cover_region.csv", row.names = F)
#usethis::use_data(MIR_2022_percent_cover_species,  overwrite = TRUE) # use this not currently working, not sure why. Use save() to write to the /data folder and then update the package.
save(MIR_2022_percent_cover_species_DUMMY, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_percent_cover_species.rda")
#usethis::use_data(MIR_2022_percent_cover_site,  overwrite = TRUE)
save(MIR_2022_percent_cover_site, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_percent_cover_site.rda")
#usethis::use_data(MIR_2022_cover_strata,  overwrite = TRUE)
save(MIR_2022_cover_strata, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_cover_strata.rda")
#usethis::use_data(MIR_2022_cover_region,  overwrite = TRUE)
save(MIR_2022_cover_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_cover_region.rda")
```
###### Species
```{r}
# Run function and assign names to dataframes 
tmp <-NCRMP_colony_percent_cover(region = "FLK",
                                 ptitle = "MIR - Florida Keys - DUMMY",
                                 file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures",
                                 project = "MIR")
MIR_2022_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(MIR_2022_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_percent_cover_region_species.csv", row.names = F)
#usethis::use_data(MIR_2022_percent_cover_region_species,  overwrite = TRUE)
save(MIR_2022_percent_cover_region_species, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_percent_cover_region_species.rda")
```
##### Mortality 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "MIR",
                                     region = "FLK",
                                     species_filter = "FALSE")
MIR_2022_old_mort_site_DUMMY <- tmp$old_mortality_site
MIR_2022_rec_mort_site_DUMMY <- tmp$recent_mortality_site
MIR_2022_old_mort_strata_DUMMY <- tmp$old_mortality_strata
MIR_2022_rec_mort_strata_DUMMY <- tmp$rec_mortality_strata
MIR_2022_old_mort_region_DUMMY <- tmp$Domain_est_old_mort
MIR_2022_rec_mort_region_DUMMY <- tmp$Domain_est_rec_mort
# Export data 
write.csv(MIR_2022_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_old_mort_site.csv", row.names = F) 
write.csv(MIR_2022_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FLK_14_18_rec_mort_site.csv", row.names = F)
write.csv(MIR_2022_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_old_mort_strata.csv", row.names = F)
write.csv(MIR_2022_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_rec_mort_strata.csv", row.names = F)
write.csv(MIR_2022_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_old_mort_region.csv", row.names = F)
write.csv(MIR_2022_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_rec_mort_region.csv", row.names = F)
usethis::use_data(MIR_2022_rec_mort_site,  overwrite = TRUE)
usethis::use_data(MIR_2022_old_mort_site,  overwrite = TRUE)
usethis::use_data(MIR_2022_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(MIR_2022_old_mort_strata,  overwrite = TRUE)
usethis::use_data(MIR_2022_rec_mort_region,  overwrite = TRUE)
usethis::use_data(MIR_2022_old_mort_region,  overwrite = TRUE)
```
##### Disease and bleaching 
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "MIR",
                                                       region = "FLK",
                                                       species_filter = "FALSE")
MIR_2022_dis_ble_prev_species_DUMMY <- tmp$dis_ble_prev_species
MIR_2022_dis_ble_prev_site <- tmp$dis_ble_prev_site
MIR_2022_dis_prev_strata <- tmp$dis_prev_strata
MIR_2022_ble_prev_strata <- tmp$ble_prev_strata
MIR_2022_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(MIR_2022_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_dis_ble_prev_species.csv", row.names = F)
write.csv(MIR_2022_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_dis_ble_prev_site.csv", row.names = F)
write.csv(MIR_2022_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_dis_prev_strata.csv", row.names = F)
write.csv(MIR_2022_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_ble_prev_strata.csv", row.names = F)
write.csv(MIR_2022_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_dis_ble_prev_region.csv", row.names = F)
# usethis::use_data(MIR_2022_dis_ble_prev_species,  overwrite = TRUE)
save(MIR_2022_dis_ble_prev_species_DUMMY, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_dis_ble_prev_species_DUMMY.rda")
# usethis::use_data(MIR_2022_dis_ble_prev_site,  overwrite = TRUE)
save(MIR_2022_dis_ble_prev_site, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_dis_ble_prev_site.rda")
# usethis::use_data(MIR_2022_dis_prev_strata,  overwrite = TRUE)
save(MIR_2022_dis_prev_strata, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_dis_prev_strata.rda")
# usethis::use_data(MIR_2022_ble_prev_strata,  overwrite = TRUE)
save(MIR_2022_ble_prev_strata, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_ble_prev_strata.rda")
# usethis::use_data(MIR_2022_dis_ble_prev_region,  overwrite = TRUE)
save(MIR_2022_dis_ble_prev_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_dis_ble_prev_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="MIR",
                                                             region = "FLK")
MIR_2022_dis_prev_species_region <- tmp$DomainEst_dis
MIR_2022_ble_prev_species_region <- tmp$DomainEst_bl
write.csv(MIR_2022_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_dis_prev_species_region.csv", row.names = F)
write.csv(MIR_2022_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_ble_prev_species_region.csv", row.names = F)
#usethis::use_data(MIR_2022_dis_prev_species_region,  overwrite = TRUE)
save(MIR_2022_dis_prev_species_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_dis_prev_species_region.rda")
#usethis::use_data(MIR_2022_ble_prev_species_region,  overwrite = TRUE)
save(MIR_2022_ble_prev_species_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_ble_prev_species_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "MIR",
                                                    region = "FLK",
                                                    species_filter = "FALSE")
MIR_2022_dis_ble_PA_site <- tmp$dis_ble_prev_site
MIR_2022_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
MIR_2022_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(MIR_2022_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_dis_ble_PA_site.csv", row.names = F)
write.csv(MIR_2022_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_dis_n_sites_per_strata.csv", row.names = F)
write.csv(MIR_2022_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_dis_ble_n_sites_per_region.csv", row.names = F)
#usethis::use_data(MIR_2022_dis_ble_PA_site,  overwrite = TRUE)
save(MIR_2022_ble_prev_species_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_ble_prev_species_region.rda")
#usethis::use_data(MIR_2022_dis_n_sites_per_strata,  overwrite = TRUE)
save(MIR_2022_ble_prev_species_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/MIR_2022_ble_prev_species_region.rda")
#usethis::use_data(MIR_2022_dis_ble_n_sites_per_region,  overwrite = TRUE)
```
##### Colony size
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "MIR",
                                            region = "FLK",
                                            species_filter = "FALSE")
MIR_2022_col_size_species <- tmp$size_species
MIR_2022_col_size_site <- tmp$size_site
MIR_2022_col_size_cm2_strata <- tmp$size_est_cm2_strata
MIR_2022_col_size_cm3_strata <- tmp$size_est_cm3_strata
MIR_2022_col_size_region <- tmp$Domain_est
# Export data
write.csv(MIR_2022_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_col_size_species.csv", row.names = F)
write.csv(MIR_2022_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\MIR_2022_col_size_site.csv", row.names = F)
write.csv(MIR_2022_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_col_size_cm2_strata.csv", row.names = F)
write.csv(MIR_2022_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\MIR_2022_col_size_cm3_strata.csv", row.names = F)
write.csv(MIR_2022_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\MIR_2022_col_size_region.csv", row.names = F)
# copy to console and run
usethis::use_data(MIR_2022_col_size_species,  overwrite = TRUE)
usethis::use_data(MIR_2022_col_size_site,  overwrite = TRUE)
usethis::use_data(MIR_2022_col_size_cm2_strata,  overwrite = TRUE)
usethis::use_data(MIR_2022_col_size_cm3_strata,  overwrite = TRUE)
usethis::use_data(MIR_2022_col_size_region,  overwrite = TRUE)
```
##### Diadema density
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "FLK", project = "MIR")
MIR_2022_invert_den_site <- tmp$diadema_density_site
MIR_2022_invert_den_strata <- tmp$invert_strata # Right now just diadema
MIR_2022_invert_den_region <- tmp$Domain_est
# Export data 
write.csv(MIR_2022_invert_den_site, "K:\\_BioGeoProjects\\Data Analysis\\Analysis ready data\\Data Queries\\Invertebrates\\MIR_2022_invert_den_site.csv", row.names = F)
write.csv(MIR_2022_invert_den_strata, "K:\\_BioGeoProjects\\Data Analysis\\Analysis ready data\\Data Queries\\Invertebrates\\MIR_2022_invert_den_strata.csv", row.names = F)
write.csv(MIR_2022_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Invertebrates\\MIR_2022_invert_den_region.csv", row.names = F)
# copy to console and run
usethis::use_data(MIR_2022_invert_den_site,  overwrite = TRUE)
usethis::use_data(MIR_2022_invert_den_strata,  overwrite = TRUE)
usethis::use_data(MIR_2022_invert_den_region,  overwrite = TRUE)
# Don't forget to delete the previous years output in the R package and in the Data Queries folder 
```


###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_Tort_2014_22_density_region,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    test_type = "Years",
                    n_years = 4, # this needs to be updated in conjunction with updating the t test function to accommodate more years
                    return_dataframe = FALSE)
```
##### Density CV and occurrence 
```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "Tortugas",
                                              ptitle = "Dry Tortugas",
                                              year = 2022,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "NCRMP")
NCRMP_Tort_Occ_Den_CV <- tmp$region_means
NCRMP_Tort_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_Tort_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_Tort_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_Tort_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_Tort_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_Occ_Den_CV_20,  overwrite = TRUE)
```

##### Density CV and occurrence - NCRMP + DRM  
```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "Tortugas",
                                              ptitle = "Dry Tortugas",
                                              year = 2022,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures/NCRMP_DRM" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "NCRMP_DRM")
NCRMP_DRM_Tort_Occ_Den_CV <- tmp$region_means
NCRMP_DRM_Tort_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_DRM_Tort_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_DRM_Tort_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_DRM_Tort_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_Tort_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_Occ_Den_CV_20,  overwrite = TRUE)
```
##### Species richness - NCRMP only
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "Tortugas")
NCRMP_Tort_2014_22_spp_list <- tmp$species_list 
NCRMP_Tort_2014_22_richness_site <- tmp$richness_site
NCRMP_Tort_2014_22_richness_strata <- tmp$richness_strata
NCRMP_Tort_2014_22_richness_region <- tmp$Domain_est
NCRMP_Tort_2014_22_diversity_site <- tmp$species_diversity_site
NCRMP_Tort_2014_22_diversity_strata <- tmp$diversity_strata
NCRMP_Tort_2014_22_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_Tort_2014_22_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_richness_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_richness_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_Tort_2014_22_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_Tort_2014_22_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_diversity_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_diversity_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_Tort_2014_22_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### DRM Species richness - NCRMP + DRM 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP_DRM",
                                                       region = "Tortugas")
NCRMP_DRM_Tort_2014_22_spp_list <- tmp$species_list 
NCRMP_DRM_Tort_2014_22_richness_site <- tmp$richness_site
NCRMP_DRM_Tort_2014_22_richness_strata <- tmp$richness_strata
NCRMP_DRM_Tort_2014_22_richness_region <- tmp$Domain_est
NCRMP_DRM_Tort_2014_22_diversity_site <- tmp$species_diversity_site
NCRMP_DRM_Tort_2014_22_diversity_strata <- tmp$diversity_strata
NCRMP_DRM_Tort_2014_22_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_DRM_Tort_2014_22_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_Tort_2014_22_richness_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_Tort_2014_22_richness_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_Tort_2014_22_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_DRM_Tort_2014_22_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_Tort_2014_22_diversity_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_Tort_2014_22_diversity_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_Tort_2014_22_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### Percent cover
###### Region 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_cover(region = "Tortugas", project = "NCRMP")
NCRMP_Tort_2014_22_percent_cover_species <- tmp$percent_cover_species
NCRMP_Tort_2014_22_percent_cover_site <- tmp$percent_cover_site
NCRMP_Tort_2014_22_cover_group_key <- tmp$cover_group_key
NCRMP_Tort_2014_22_cover_strata <- tmp$cover_strata
NCRMP_Tort_2014_22_cover_region <- tmp$Domain_est
NCRMP_Tort_2014_22_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations # from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(NCRMP_Tort_2014_22_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_Tort_2014_22_percent_cover_species.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_percent_cover_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_cover_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_cover_region.csv", row.names = F)
usethis::use_data(NCRMP_Tort_2014_22_percent_cover_species,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_percent_cover_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_cover_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_cover_region,  overwrite = TRUE)
```
###### Species
```{r}
# Run function and assign names to dataframes 
tmp <-NCRMP_colony_percent_cover(region = "Tortugas",
                                 ptitle = "The Dry Tortugas",
                                 file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" )
NCRMP_Tort_2014_22_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(NCRMP_Tort_2014_22_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_percent_cover_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_2014_22_percent_cover_region_species,  overwrite = TRUE)
```
##### Mortality - NCRMP only 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP",
                                     region = "Tortugas",
                                     species_filter = "FALSE")
NCRMP_Tort_2014_22_old_mort_site <- tmp$old_mortality_site
NCRMP_Tort_2014_22_rec_mort_site <- tmp$recent_mortality_site
NCRMP_Tort_2014_22_old_mort_strata <- tmp$old_mortality_strata
NCRMP_Tort_2014_22_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_Tort_2014_22_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_Tort_2014_22_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_Tort_2014_22_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_Tort_2014_22_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_Tort_2014_22_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_old_mort_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_old_mort_region.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_rec_mort_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_2014_22_rec_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_old_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_old_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_rec_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_old_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_old_mort_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_rec_mort_species_region,  overwrite = TRUE)
# Don't forget to delete the previous years output in the R package and in the Data Queries folder 
```
##### DRM Mortality - NCRMP + DRM 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP_DRM",
                                     region = "Tortugas",
                                     species_filter = "FALSE")
NCRMP_DRM_Tort_2014_22_old_mort_site <- tmp$old_mortality_site
NCRMP_DRM_Tort_2014_22_rec_mort_site <- tmp$recent_mortality_site
NCRMP_DRM_Tort_2014_22_old_mort_strata <- tmp$old_mortality_strata
NCRMP_DRM_Tort_2014_22_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_DRM_Tort_2014_22_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_DRM_Tort_2014_22_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_DRM_Tort_2014_22_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_DRM_Tort_2014_22_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_DRM_Tort_2014_22_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_Tort_2014_22_old_mort_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_Tort_2014_22_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_Tort_2014_22_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_Tort_2014_22_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_old_mort_region.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_rec_mort_species_region.csv", row.names = F)
# must be copied to console to run
usethis::use_data(NCRMP_DRM_Tort_2014_22_rec_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_old_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_old_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_rec_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_old_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_old_mort_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_rec_mort_species_region,  overwrite = TRUE)
# Don't forget to delete the previous years output in the R package and in the Data Queries folder 
```
##### Disease and bleaching - NCRMP only
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP",
                                                       region = "Tortugas",
                                                       species_filter = "FALSE")
NCRMP_Tort_2014_22_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_Tort_2014_22_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_Tort_2014_22_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_Tort_2014_22_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_Tort_2014_22_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_Tort_2014_22_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_dis_ble_prev_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_2014_22_dis_ble_prev_species,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_dis_ble_prev_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_ble_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_dis_ble_prev_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP",
                                                             region = "Tortugas")
NCRMP_Tort_2014_22_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_Tort_2014_22_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_Tort_2014_22_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_ble_prev_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_2014_22_dis_prev_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_ble_prev_species_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP",
                                                    region = "Tortugas",
                                                    species_filter = "FALSE")
NCRMP_Tort_2014_22_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_Tort_2014_22_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_Tort_2014_22_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_Tort_2014_22_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_dis_ble_n_sites_per_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_2014_22_dis_ble_PA_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_dis_n_sites_per_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_dis_ble_n_sites_per_region,  overwrite = TRUE)
```
##### DRM Disease prevalence - NCRMP + DRM 
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP_DRM",
                                                       region = "Tortugas",
                                                       species_filter = "FALSE")
NCRMP_DRM_Tort_2014_22_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_DRM_Tort_2014_22_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_DRM_Tort_2014_22_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_DRM_Tort_2014_22_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_DRM_Tort_2014_22_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_DRM_Tort_2014_22_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_Tort_2014_22_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_Tort_2014_22_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_Tort_2014_22_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_Tort_2014_22_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_dis_ble_prev_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_ble_prev_species,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_ble_prev_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_ble_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_ble_prev_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP_DRM",
                                                             region = "Tortugas")
NCRMP_DRM_Tort_2014_22_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_DRM_Tort_2014_22_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_DRM_Tort_2014_22_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_ble_prev_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_prev_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_ble_prev_species_region,  overwrite = TRUE)
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP_DRM",
                                                    region = "Tortugas",
                                                    species_filter = "FALSE")
NCRMP_DRM_Tort_2014_22_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_DRM_Tort_2014_22_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_DRM_Tort_2014_22_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_DRM_Tort_2014_22_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_DRM_Tort_2014_22_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_DRM_Tort_2014_22_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_22_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_dis_ble_n_sites_per_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_ble_PA_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_n_sites_per_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_22_dis_ble_n_sites_per_region,  overwrite = TRUE)
```
##### Colony size
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP",
                                            region = "Tortugas",
                                            species_filter = "FALSE")
NCRMP_Tort_2014_22_col_size_species <- tmp$size_species
NCRMP_Tort_2014_22_col_size_site <- tmp$size_site
NCRMP_Tort_2014_22_col_size_cm2_strata <- tmp$size_est_cm2_strata
NCRMP_Tort_2014_22_col_size_cm3_strata <- tmp$size_est_cm3_strata
NCRMP_Tort_2014_22_col_size_region <- tmp$Domain_est
NCRMP_Tort_2014_22_col_size_region_species <- tmp$Domain_est_species
# species-specific ntot check
unique(tmp$ntot_check_species$wh_sum)
# Export data
write.csv(NCRMP_Tort_2014_22_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_col_size_species.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_Tort_2014_22_col_size_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_col_size_cm2_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_Tort_2014_22_col_size_cm3_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_Tort_2014_22_col_size_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_2014_22_col_size_species,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_col_size_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_col_size_cm2_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_col_size_cm3_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_col_size_region,  overwrite = TRUE)
```
##### Colony size - NCRMP + DRM 
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP_DRM",
                                            region = "Tortugas",
                                            species_filter = "FALSE")
NCRMP_DRM_Tort_2014_22_col_size_region_species <- tmp$Domain_est_species
# species-specific ntot check
unique(tmp$ntot_check_species$wh_sum)
write.csv(NCRMP_DRM_Tort_2014_22_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_DRM_Tort_2014_22_col_size_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_DRM_Tort_2014_22_col_size_region_species,  overwrite = TRUE)
```
##### Diadema density
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "Tortugas", project = "NCRMP")
NCRMP_Tort_2014_22_invert_den_site <- tmp$diadema_density_site
NCRMP_Tort_2014_22_invert_den_strata <- tmp$invert_strata # Right now just diadema
NCRMP_Tort_2014_22_invert_den_region <- tmp$Domain_est # just diadema for now
# Export data 
write.csv(NCRMP_Tort_2014_22_invert_den_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_Tort_2014_22_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_invert_den_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_Tort_2014_22_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_22_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_Tort_2014_22_invert_den_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_Tort_2014_22_invert_den_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_invert_den_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_22_invert_den_region,  overwrite = TRUE)
```
# GOM
##### Loading data exported from QAQC
```{r}
#Note I exported the data into an analysis ready data subfolder in the QAQC RMD folder I made for FGB, I then copied the files over to my local drive to then save in the analysis package
FGBNMS_2024_benthic_cover=read.csv("C:/Users/Lexie.Sturm/Documents/NCRMP Files/Data/analysisReadyData/AR_DATA_FGBNMS_2024/FGBNMS_2024_benthic_cover.csv")
FGBNMS_2024_coral_demographics=read.csv("C:/Users/Lexie.Sturm/Documents/NCRMP Files/Data/analysisReadyData/AR_DATA_FGBNMS_2024/FGBNMS_2024_coral_demographics.csv")
FGBNMS_2024_inverts_ESAcorals=read.csv("C:/Users/Lexie.Sturm/Documents/NCRMP Files/Data/analysisReadyData/AR_DATA_FGBNMS_2024/FGBNMS_2024_inverts_ESAcorals.csv")
FGBNMS_2024_NTOT= read.csv("C:/Users/Lexie.Sturm/Documents/NCRMP Files/Data/analysisReadyData/AR_DATA_FGBNMS_2024/FGBNMS_2024_NTOT.csv") %>%
#rename("STRAT" = "ANALYSIS_STRATUM")
rename(ANALYSIS_STRATUM = STRAT)
FGBNMS_2024_NTOT <- FGBNMS_2024_NTOT 
# save(FGBNMS_2024_benthic_cover, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/FGBNMS_2024_benthic_cover.rda")
# save(FGBNMS_2024_coral_demographics, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/FGBNMS_2024_coral_demographics.rda")
# save(FGBNMS_2024_inverts_ESAcorals, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/FGBNMS_2024_inverts_ESAcorals.rda")
# save(FGBNMS_2024_NTOT, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/FGBNMS_2024_NTOT.rda")
# These an be run in the console but not in the code chunk bc Rmd resets the wd after each chunk is run
usethis::use_data(FGBNMS_2024_benthic_cover,  overwrite = TRUE)
usethis::use_data(FGBNMS_2024_coral_demographics,  overwrite = TRUE)
usethis::use_data(FGBNMS_2024_inverts_ESAcorals,  overwrite = TRUE)
usethis::use_data(FGBNMS_2024_NTOT,  overwrite = TRUE)
```
##### Coral density

###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_FGBNMS_2013_24_density_region,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    n_years = 4,
                    return_dataframe = FALSE)
```
##### Density CV and occurrence 
```{r}
# In order for this function to run, you first need to commit NCRMP_FGBNMS_2013_24_density_species from above to the package. 
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "GOM",
                                              ptitle = "Flower Garden Banks",
                                              year = 2024,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "NCRMP")
NCRMP_FGBNMS_Occ_Den_CV <- tmp$region_means
NCRMP_FGBNMS_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_FGBNMS_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_FGBNMS_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_FGBNMS_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_FGBNMS_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_Occ_Den_CV_20,  overwrite = TRUE)
```
##### Species richness  
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "GOM")
NCRMP_FGBNMS_2013_24_spp_list <- tmp$species_list 
NCRMP_FGBNMS_2013_24_richness_site <- tmp$richness_site
NCRMP_FGBNMS_2013_24_richness_strata <- tmp$richness_strata #ok that this does not have rugosity code or PROT?
NCRMP_FGBNMS_2013_24_richness_region <- tmp$Domain_est
NCRMP_FGBNMS_2013_24_diversity_site <- tmp$species_diversity_site
NCRMP_FGBNMS_2013_24_diversity_strata <- tmp$diversity_strata #No PROT?
NCRMP_FGBNMS_2013_24_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_FGBNMS_2013_24_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_richness_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_richness_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_richness_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_FGBNMS_2013_24_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2014_24_diversity_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2014_24_diversity_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2014_24_diversity_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### Percent cover
###### Region 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_cover(region = "GOM", project = "NCRMP")
NCRMP_FGBNMS_2013_24_percent_cover_species <- tmp$percent_cover_species
NCRMP_FGBNMS_2013_24_percent_cover_site <- tmp$percent_cover_site
NCRMP_FGBNMS_2013_24_cover_group_key <- tmp$cover_group_key
NCRMP_FGBNMS_2013_24_cover_strata <- tmp$cover_strata
NCRMP_FGBNMS_2013_24_cover_region <- tmp$Domain_est
NCRMP_FGBNMS_2013_24_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that # was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations # from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(NCRMP_FGBNMS_2013_24_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_FGBNMS_2013_24_percent_cover_species.csv", row.names = F)
#T:\NCRMP\Data Analysis\Analysis ready data\Data Queries\R Package Exports\Species level metrics
write.csv(NCRMP_FGBNMS_2013_24_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_percent_cover_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_cover_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_cover_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_percent_cover_species,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_percent_cover_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_cover_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_cover_region,  overwrite = TRUE)
```
###### Species
```{r}
# Run function and assign names to dataframes. NCRMP_FGBNMS_2013_24_percent_cover_species created above needs to be added to the package before this function can run.
tmp <-NCRMP_colony_percent_cover(region = "GOM",
                                 ptitle = "Flower Garden Banks",
                                 file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" )
NCRMP_FGBNMS_2013_24_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(NCRMP_FGBNMS_2013_24_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_percent_cover_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_percent_cover_region_species,  overwrite = TRUE)
```
###### Percent cover t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_FGBNMS_2013_24_cover_region,
                    metric1 = 'coral_cover',
                    metric2 = 'avCvr',
                    #test_type = "Years",
                    alpha = 0.05,
                    n_years = 5,
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_FGBNMS_2013_24_cover_region,
                    metric1 = 'macroalgae_cover',
                    metric2 = 'avCvr',
                    #test_type = "Years",
                    alpha = 0.05,
                    n_years = 5,
                    return_dataframe = FALSE)
```
##### Mortality
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP",
                                     region = "GOM",
                                     species_filter = "FALSE")
NCRMP_FGBNMS_2013_24_old_mort_site <- tmp$old_mortality_site
NCRMP_FGBNMS_2013_24_rec_mort_site <- tmp$recent_mortality_site
NCRMP_FGBNMS_2013_24_old_mort_strata <- tmp$old_mortality_strata
NCRMP_FGBNMS_2013_24_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_FGBNMS_2013_24_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_FGBNMS_2013_24_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_FGBNMS_2013_24_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_FGBNMS_2013_24_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_FGBNMS_2013_24_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_old_mort_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_old_mort_region.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_rec_mort_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_rec_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_old_mort_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_old_mort_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_rec_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_old_mort_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_old_mort_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_rec_mort_species_region,  overwrite = TRUE)
# remove old data objects
```
###### Mortality t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_FGBNMS_2013_24_old_mort_region,
                    metric1 = "old_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 5,
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_FGBNMS_2013_24_rec_mort_region,
                    metric1 = "recent_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 5,
                    return_dataframe = FALSE)
```
##### Disease and bleaching 
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP",
                                                       region = "GOM",
                                                       species_filter = "FALSE")
NCRMP_FGBNMS_2013_24_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_FGBNMS_2013_24_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_FGBNMS_2013_24_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_FGBNMS_2013_24_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_FGBNMS_2013_24_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_FGBNMS_2013_24_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_dis_ble_prev_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_ble_prev_species,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_ble_prev_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_ble_prev_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_ble_prev_region,  overwrite = TRUE)
###################
  
  #NCRMP_FGBNMS_2013_24_dis_ble_prev_species created above needs to be added to the package before this function can run.
  
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP",
                                                               region = "GOM")
NCRMP_FGBNMS_2013_24_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_FGBNMS_2013_24_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_FGBNMS_2013_24_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_ble_prev_species_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_prev_species_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_ble_prev_species_region,  overwrite = TRUE)
#####################
  
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP",
                                                      region = "GOM",
                                                      species_filter = "FALSE")
NCRMP_FGBNMS_2013_24_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_FGBNMS_2013_24_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_FGBNMS_2013_24_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_FGBNMS_2013_24_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_dis_ble_n_sites_per_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_ble_PA_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_n_sites_per_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_dis_ble_n_sites_per_region,  overwrite = TRUE)
```
##### Colony size
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP",
                                            region = "GOM",
                                            species_filter = "FALSE")
NCRMP_FGBNMS_2013_24_col_size_species <- tmp$size_species
NCRMP_FGBNMS_2013_24_col_size_site <- tmp$size_site
NCRMP_FGBNMS_2013_24_col_size_cm2_strata <- tmp$size_est_cm2_strata
NCRMP_FGBNMS_2013_24_col_size_cm3_strata <- tmp$size_est_cm3_strata
NCRMP_FGBNMS_2013_24_col_size_region <- tmp$Domain_est
NCRMP_FGBNMS_2013_24_col_size_region_species <- tmp$Domain_est_species
# species-specific ntot check
unique(tmp$ntot_check_species$wh_sum)
# Export data
write.csv(NCRMP_FGBNMS_2013_24_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_col_size_species.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_FGBNMS_2013_24_col_size_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_col_size_cm2_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_FGBNMS_2013_24_col_size_cm3_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_col_size_region.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_FGBNMS_2013_24_col_size_region_species.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_FGBNMS_2013_24_col_size_species,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_col_size_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_col_size_cm2_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_col_size_cm3_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_col_size_region,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_col_size_region_species,  overwrite = TRUE)
```
###### Colony size t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_FGBNMS_2013_24_col_size_region,
                    metric1 = 'colony_size',
                    metric2 = 'avCm3',
                    alpha = 0.05,
                    n_years = 5,
                    return_dataframe = FALSE)
```
##### Diadema density
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "GOM")
NCRMP_FGBNMS_2013_24_invert_den_site <- tmp$diadema_density_site
NCRMP_FGBNMS_2013_24_invert_den_strata <- tmp$invert_strata # Right now just diadema
NCRMP_FGBNMS_2013_24_invert_den_region <- tmp$Domain_est
# Export data 
write.csv(NCRMP_FGBNMS_2013_24_invert_den_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_FGBNMS_2013_24_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_invert_den_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_FGBNMS_2013_24_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_24_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_FGBNMS_2013_24_invert_den_region.csv", row.names = F)
usethis::use_data(NCRMP_FGBNMS_2013_24_invert_den_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_invert_den_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_24_invert_den_region,  overwrite = TRUE)
```

###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_STTSTJ_2013_23_density_region,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    n_years = 5,
                    test_type = "Years",
                    return_dataframe = FALSE)
```
##### Density CV and occurrence 
```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "STTSTJ",
                                              ptitle = "St. Thomas & St. John",
                                              year = 2023,
                                              file_path = "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data" ,  #must be connected to VPN if filepath is to a network drive
                                              species_filter = "NULL",
                                              project = "NCRMP")
NCRMP_STTSTJ_Occ_Den_CV <- tmp$region_means
NCRMP_STTSTJ_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_STTSTJ_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_STTSTJ_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_STTSTJ_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_STTSTJ_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_STTSTJ_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_Occ_Den_CV_20,  overwrite = TRUE)
```
##### Species richness  
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "STTSTJ")
NCRMP_STTSTJ_2013_23_spp_list <- tmp$species_list 
NCRMP_STTSTJ_2013_23_richness_site <- tmp$richness_site
NCRMP_STTSTJ_2013_23_richness_strata <- tmp$richness_strata
NCRMP_STTSTJ_2013_23_richness_region <- tmp$Domain_est
NCRMP_STTSTJ_2013_23_diversity_site <- tmp$species_diversity_site
NCRMP_STTSTJ_2013_23_diversity_strata <- tmp$diversity_strata
NCRMP_STTSTJ_2013_23_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_STTSTJ_2013_23_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_richness_site.csv", row.names = F)
# 
write.csv(NCRMP_STTSTJ_2013_23_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_richness_strata.csv", row.names = F)
# 
write.csv(NCRMP_STTSTJ_2013_23_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_richness_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_STTSTJ_2013_23_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_23_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_23_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_STTSTJ_2013_23_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_diversity_site.csv", row.names = F)
# 
write.csv(NCRMP_STTSTJ_2013_23_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_diversity_strata.csv", row.names = F)
# 
write.csv(NCRMP_STTSTJ_2013_23_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_diversity_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_STTSTJ_2013_23_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_23_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_23_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### Percent cover
###### Region 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_cover(region = "STTSTJ", project = "NCRMP")
NCRMP_STTSTJ_2013_23_percent_cover_species <- tmp$percent_cover_species
NCRMP_STTSTJ_2013_23_percent_cover_site <- tmp$percent_cover_site
NCRMP_STTSTJ_2013_23_cover_group_key <- tmp$cover_group_key
NCRMP_STTSTJ_2013_23_cover_strata <- tmp$cover_strata
NCRMP_STTSTJ_2013_23_cover_region <- tmp$Domain_est
NCRMP_STTSTJ_2013_23_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that # was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations # from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(NCRMP_STTSTJ_2013_23_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_STTSTJ_2013_23_percent_cover_species.csv", row.names = F)
#T:\NCRMP\Data Analysis\Analysis ready data\Data Queries\R Package Exports\Species level metrics
write.csv(NCRMP_STTSTJ_2013_23_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_percent_cover_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_cover_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_cover_region.csv", row.names = F)
# usethis::use_data(NCRMP_STTSTJ_2013_21_percent_cover_species,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_percent_cover_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_percent_cover_species.rda")
# usethis::use_data(NCRMP_STTSTJ_2013_21_percent_cover_site,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_percent_cover_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_percent_cover_site.rda")
# usethis::use_data(NCRMP_STTSTJ_2013_21_cover_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_cover_strata, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_cover_strata.rda")
# usethis::use_data(NCRMP_STTSTJ_2013_21_cover_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_cover_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_percent_cover_region.rda")
```
###### Species
```{r}
# Run function and assign names to dataframes 
tmp <-NCRMP_colony_percent_cover(region = "STTSTJ",
                                 ptitle = "St. Thomas & St. John",
                                 file_path = "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Figures" )
NCRMP_STTSTJ_2013_23_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(NCRMP_STTSTJ_2013_23_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_percent_cover_region_species.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_percent_cover_region_species,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_percent_cover_region_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_percent_cover_region_species.rda")
```
###### Percent cover t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_STTSTJ_2013_23_cover_region,
                    metric1 = 'coral_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    n_years = 6,
                    #test_type = "Years",
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_STTSTJ_2013_23_cover_region,
                    metric1 = 'macroalgae_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    n_years = 6,
                    #test_type = "Years",
                    return_dataframe = FALSE)
```
##### Mortality
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP",
                                     region = "STTSTJ",
                                     species_filter = "FALSE")
NCRMP_STTSTJ_2013_23_old_mort_site <- tmp$old_mortality_site
NCRMP_STTSTJ_2013_23_rec_mort_site <- tmp$recent_mortality_site
NCRMP_STTSTJ_2013_23_old_mort_strata <- tmp$old_mortality_strata
NCRMP_STTSTJ_2013_23_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_STTSTJ_2013_23_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_STTSTJ_2013_23_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_STTSTJ_2013_23_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_STTSTJ_2013_23_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_STTSTJ_2013_23_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_old_mort_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_old_mort_region.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_rec_mort_species_region.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_rec_mort_site,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_rec_mort_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_rec_mort_site.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_old_mort_site,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_old_mort_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_old_mort_site.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_rec_mort_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_rec_mort_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_rec_mort_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_old_mort_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_old_mort_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_old_mort_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_rec_mort_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_rec_mort_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_rec_mort_region.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_old_mort_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_old_mort_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_old_mort_region.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_rec_mort_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_rec_mort_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_rec_mort_species_region.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_old_mort_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_old_mort_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_old_mort_species_region.rda")
```
###### Mortality t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_STTSTJ_2013_23_old_mort_region,
                    metric1 = "old_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 6,
                    #test_type = "Years",
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_STTSTJ_2013_23_rec_mort_region,
                    metric1 = "recent_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 6,
                    #test_type = "Years",
                    return_dataframe = FALSE)
```
##### Disease and bleaching 
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP",
                                                       region = "STTSTJ",
                                                       species_filter = "FALSE")
NCRMP_STTSTJ_2013_23_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_STTSTJ_2013_23_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_STTSTJ_2013_23_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_STTSTJ_2013_23_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_STTSTJ_2013_23_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_STTSTJ_2013_23_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_STTSTJ_2013_23_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_dis_ble_prev_region.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_ble_prev_species,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_ble_prev_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_ble_prev_species.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_ble_prev_site,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_ble_prev_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_ble_prev_site.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_prev_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_prev_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_prev_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_ble_prev_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_ble_prev_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_ble_prev_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_ble_prev_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_ble_prev_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_ble_prev_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP",
                                                             region = "STTSTJ")
NCRMP_STTSTJ_2013_23_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_STTSTJ_2013_23_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_STTSTJ_2013_23_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_ble_prev_species_region.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_prev_species_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_prev_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_prev_species_region.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_ble_prev_species_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_ble_prev_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_ble_prev_species_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP",
                                                    region = "STTSTJ",
                                                    species_filter = "FALSE")
NCRMP_STTSTJ_2013_23_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_STTSTJ_2013_23_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_STTSTJ_2013_23_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_STTSTJ_2013_23_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_dis_ble_n_sites_per_region.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_ble_PA_site,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_ble_PA_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_ble_PA_site.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_n_sites_per_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_n_sites_per_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_n_sites_per_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_ble_n_sites_per_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_dis_ble_n_sites_per_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_dis_ble_n_sites_per_region.rda")
```
##### Colony size
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP",
                                            region = "STTSTJ",
                                            species_filter = "FALSE")
NCRMP_STTSTJ_2013_23_col_size_species <- tmp$size_species
NCRMP_STTSTJ_2013_23_col_size_site <- tmp$size_site
NCRMP_STTSTJ_2013_23_col_size_cm2_strata <- tmp$size_est_cm2_strata
NCRMP_STTSTJ_2013_23_col_size_cm3_strata <- tmp$size_est_cm3_strata
NCRMP_STTSTJ_2013_23_col_size_region <- tmp$Domain_est
NCRMP_STTSTJ_2013_23_col_size_region_species <- tmp$Domain_est_species
# Export data
write.csv(NCRMP_STTSTJ_2013_23_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_STTSTJ_2013_23_col_size_species.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_23_col_size_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_col_size_cm2_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_23_col_size_cm3_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_col_size_region.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_23_col_size_region.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_col_size_species,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_col_size_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_col_size_species.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_col_size_site,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_col_size_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_col_size_site.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_col_size_cm2_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_col_size_cm2_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_col_size_cm2_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_col_size_cm3_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_col_size_cm3_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_col_size_cm3_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_col_size_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_col_size_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_col_size_region.rda")
save(NCRMP_STTSTJ_2013_23_col_size_region_species, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_col_size_region_species.rda")
```
###### Colony size t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_STTSTJ_2013_23_col_size_region,
                    metric1 = 'colony_size',
                    metric2 = 'avCm3',
                    alpha = 0.05,
                    n_years = 6,
                   #test_type = "Years",
                    return_dataframe = FALSE)
```
##### Diadema density
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "STTSTJ")
NCRMP_STTSTJ_2013_23_invert_den_site <- tmp$diadema_density_site
NCRMP_STTSTJ_2013_23_invert_den_strata <- tmp$invert_strata # Right now just diadema
NCRMP_STTSTJ_2013_23_invert_den_region <- tmp$Domain_est
# Export data 
write.csv(NCRMP_STTSTJ_2013_23_invert_den_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_STTSTJ_2013_23_invert_den_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_invert_den_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_STTSTJ_2013_23_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_23_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_STTSTJ_2013_23_invert_den_region.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_invert_den_site,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_invert_den_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_invert_den_site.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_invert_den_strata,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_invert_den_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_invert_den_strata.rda")
#usethis::use_data(NCRMP_STTSTJ_2013_21_invert_den_region,  overwrite = TRUE)
save(NCRMP_STTSTJ_2013_23_invert_den_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STTSTJ_2013_23_invert_den_region.rda")
```
### St. Croix  


###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_STX_2015_23_density_region,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    n_years = 5,
                    test_type = "Years",
                    return_dataframe = FALSE)
```
##### Density CV and occurrence 
```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "STX",
                                              ptitle = "St. Croix",
                                              year = 2023,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" ,
                                              species_filter = "NULL",
                                              project = "NCRMP")
NCRMP_STX_Occ_Den_CV <- tmp$region_means
NCRMP_STX_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_STX_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_STX_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_STX_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_STX_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_STX_Occ_Den_CV,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_Occ_Den_CV_20,  overwrite = TRUE)
# remove old versions
```
##### Species richness  
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "STX")
NCRMP_STX_2015_23_spp_list <- tmp$species_list 
NCRMP_STX_2015_23_richness_site <- tmp$richness_site
NCRMP_STX_2015_23_richness_strata <- tmp$richness_strata
NCRMP_STX_2015_23_richness_region <- tmp$Domain_est
NCRMP_STX_2015_23_diversity_site <- tmp$species_diversity_site
NCRMP_STX_2015_23_diversity_strata <- tmp$diversity_strata
NCRMP_STX_2015_23_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_STX_2015_23_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_richness_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_richness_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_richness_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_STX_2015_23_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_23_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_23_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_STX_2015_23_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_diversity_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_diversity_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_diversity_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_STX_2015_23_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_23_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_23_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### Percent cover
###### Region
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_cover(region = "STX", project = "NCRMP")
NCRMP_STX_2015_23_percent_cover_species <- tmp$percent_cover_species
NCRMP_STX_2015_23_percent_cover_site <- tmp$percent_cover_site
NCRMP_STX_2015_23_cover_group_key <- tmp$cover_group_key
NCRMP_STX_2015_23_cover_strata <- tmp$cover_strata
NCRMP_STX_2015_23_cover_region <- tmp$Domain_est
NCRMP_STX_2015_23_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that # was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations # from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(NCRMP_STX_2015_23_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_STX_2015_23_percent_cover_species.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_percent_cover_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_cover_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_cover_region.csv", row.names = F)
#usethis::use_data(NCRMP_STX_2015_21_percent_cover_species,  overwrite = TRUE)
save(NCRMP_STX_2015_23_percent_cover_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_percent_cover_species.rda")
#usethis::use_data(NCRMP_STX_2015_21_percent_cover_site,  overwrite = TRUE)
save(NCRMP_STX_2015_23_percent_cover_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_percent_cover_site.rda")
#usethis::use_data(NCRMP_STX_2015_21_cover_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_cover_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_cover_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_cover_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_cover_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_cover_region.rda")
```
###### Species
```{r}
# Run function and assign names to dataframes 
tmp <-NCRMP_colony_percent_cover(region = "STX",
                                 ptitle = "St. Croix",
                                 file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" )
NCRMP_STX_2015_23_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(NCRMP_STX_2015_23_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_percent_cover_region_species.csv", row.names = F)
#usethis::use_data(NCRMP_STX_2015_21_percent_cover_region_species,  overwrite = TRUE)
save(NCRMP_STX_2015_23_percent_cover_region_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_percent_cover_region_species.rda")
```
###### Percent cover t-test 
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_STX_2015_23_cover_region,
                    metric1 = 'coral_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    n_years = 5,
                    #test_type = "Years",
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_STX_2015_23_cover_region,
                    metric1 = 'macroalgae_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    n_years = 5,
                    #test_type = "Years",
                    return_dataframe = FALSE)
```
##### Mortality
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP",
                                     region = "STX",
                                     species_filter = "FALSE")
NCRMP_STX_2015_23_old_mort_site <- tmp$old_mortality_site
NCRMP_STX_2015_23_rec_mort_site <- tmp$recent_mortality_site
NCRMP_STX_2015_23_old_mort_strata <- tmp$old_mortality_strata
NCRMP_STX_2015_23_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_STX_2015_23_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_STX_2015_23_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_STX_2015_23_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_STX_2015_23_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_STX_2015_23_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_old_mort_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_old_mort_region.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_rec_mort_species_regioncsv", row.names = F)
#usethis::use_data(NCRMP_STX_2015_21_rec_mort_site,  overwrite = TRUE)
save(NCRMP_STX_2015_23_rec_mort_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_rec_mort_site.rda")
# copy to console to run
usethis::use_data(NCRMP_STX_2015_23_rec_mort_site,  overwrite = TRUE)
#usethis::use_data(NCRMP_STX_2015_23_old_mort_site,  overwrite = TRUE)
save(NCRMP_STX_2015_23_old_mort_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_old_mort_site.rda")
#usethis::use_data(NCRMP_STX_2015_21_rec_mort_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_rec_mort_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_rec_mort_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_old_mort_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_old_mort_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_old_mort_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_rec_mort_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_rec_mort_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_rec_mort_region.rda")
#usethis::use_data(NCRMP_STX_2015_21_old_mort_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_old_mort_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_old_mort_region.rda")
#usethis::use_data(NCRMP_STX_2015_23_old_mort_species_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_old_mort_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_old_mort_species_region.rda")
#usethis::use_data(NCRMP_STX_2015_21_rec_mort_species_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_rec_mort_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_rec_mort_species_region.rda")
```
###### Mortality t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_STX_2015_23_old_mort_region,
                    metric1 = "old_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 5,
                    #test_type = "Years",
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_STX_2015_23_rec_mort_region,
                    metric1 = "recent_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 5,
                    #test_type = "Years",
                    return_dataframe = FALSE)
```
##### Disease and bleaching
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP",
                                                       region = "STX",
                                                       species_filter = "FALSE")
NCRMP_STX_2015_23_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_STX_2015_23_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_STX_2015_23_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_STX_2015_23_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_STX_2015_23_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_STX_2015_23_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_STX_2015_23_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_dis_ble_prev_region.csv", row.names = F)
#usethis::use_data(NCRMP_STTSTJ_2013_21_dis_ble_prev_species,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_ble_prev_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_ble_prev_species.rda")
#usethis::use_data(NCRMP_STX_2015_21_dis_ble_prev_site,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_ble_prev_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_ble_prev_site.rda")
#usethis::use_data(NCRMP_STX_2015_21_dis_prev_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_prev_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_prev_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_ble_prev_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_ble_prev_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_ble_prev_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_dis_ble_prev_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_ble_prev_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_ble_prev_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP",
                                                             region = "STX")
NCRMP_STX_2015_23_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_STX_2015_23_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_STX_2015_23_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_ble_prev_species_region.csv", row.names = F)
#usethis::use_data(NCRMP_STX_2015_21_dis_prev_species_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_prev_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_prev_species_region.rda")
#usethis::use_data(NCRMP_STX_2015_21_ble_prev_species_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_ble_prev_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_ble_prev_species_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP",
                                                    region = "STX",
                                                    species_filter = "FALSE")
NCRMP_STX_2015_23_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_STX_2015_23_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_STX_2015_23_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_STX_2015_23_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_dis_ble_n_sites_per_region.csv", row.names = F)
#usethis::use_data(NCRMP_STX_2015_21_dis_ble_PA_site,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_ble_PA_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_ble_PA_site.rda")
#usethis::use_data(NCRMP_STX_2015_21_dis_n_sites_per_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_n_sites_per_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_n_sites_per_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_dis_ble_n_sites_per_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_dis_ble_n_sites_per_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_dis_ble_n_sites_per_region.rda")
# remove old versions
```
##### Colony size
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP",
                                            region = "STX",
                                            species_filter = "FALSE")
NCRMP_STX_2015_23_col_size_species <- tmp$size_species
NCRMP_STX_2015_23_col_size_site <- tmp$size_site
NCRMP_STX_2015_23_col_size_cm2_strata <- tmp$size_est_cm2_strata
NCRMP_STX_2015_23_col_size_cm3_strata <- tmp$size_est_cm3_strata
NCRMP_STX_2015_23_col_size_region <- tmp$Domain_est
NCRMP_STX_2015_23_col_size_region_species <- tmp$Domain_est_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_species$wh_sum)
# Export data
write.csv(NCRMP_STX_2015_23_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_col_size_species.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_23_col_size_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_col_size_cm2_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_23_col_size_cm3_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_23_col_size_region.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_21_col_size_region_species.csv", row.names = F)
#usethis::use_data(NCRMP_STX_2015_21_col_size_species,  overwrite = TRUE)
save(NCRMP_STX_2015_23_col_size_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_col_size_species.rda")
#usethis::use_data(NCRMP_STX_2015_21_col_size_site,  overwrite = TRUE)
save(NCRMP_STX_2015_23_col_size_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_col_size_site.rda")
#usethis::use_data(NCRMP_STX_2015_21_col_size_cm2_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_col_size_cm2_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_col_size_cm2_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_col_size_cm3_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_col_size_cm3_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_col_size_cm3_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_col_size_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_col_size_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_col_size_region.rda")
save(NCRMP_STX_2015_23_col_size_region_species, file = "C:/Users/Lexie.Sturm/Documents/NCRMP_STX_2015_23_col_size_region_species.rda")
```
###### Colony size t-test
```{r}
#Not working for some reason need to double check
NCRMP_perform_ttest(dataframe = NCRMP_STX_2015_23_col_size_region,
                    metric1 = 'colony_size',
                    metric2 = 'avCm3',
                    alpha = 0.05,
                    n_years = 5,
                    #test_type = "Years",
                    return_dataframe = FALSE)
```
##### Diadema density
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "STX")
NCRMP_STX_2015_23_invert_den_site <- tmp$diadema_density_site
NCRMP_STX_2015_23_invert_den_strata <- tmp$invert_strata # Right now just diadema
NCRMP_STX_2015_23_invert_den_region <- tmp$Domain_est
# Export data 
write.csv(NCRMP_STX_2015_23_invert_den_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_STX_2015_23_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_invert_den_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_STX_2015_23_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_23_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_STX_2015_23_invert_den_region.csv", row.names = F)
#usethis::use_data(NCRMP_STX_2015_21_invert_den_site,  overwrite = TRUE)
save(NCRMP_STX_2015_23_invert_den_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_invert_den_site.rda")
#usethis::use_data(NCRMP_STX_2015_21_invert_den_strata,  overwrite = TRUE)
save(NCRMP_STX_2015_23_invert_den_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_invert_den_strata.rda")
#usethis::use_data(NCRMP_STX_2015_21_invert_den_region,  overwrite = TRUE)
save(NCRMP_STX_2015_23_invert_den_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_STX_2015_23_invert_den_region.rda")
# remove old versions
```

###### Density t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_PRICO_2014_23_density_region,
                    metric1 = 'density',
                    metric2 = 'avDen',
                    alpha = 0.05,
                    n_years = 5,
                    #test_type = "Years",
                    return_dataframe = FALSE)
```
##### Density CV and occurrence 
```{r}
tmp <- NCRMP_DRM_colony_density_CV_and_occurrence(region = "PRICO",
                                              ptitle = "Puerto Rico",
                                              year = 2023,
                                              file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" ,
                                              species_filter = "NULL",
                                              project = "NCRMP")
NCRMP_PRICO_Occ_Den_CV <- tmp$region_means
NCRMP_PRICO_Occ_Den_CV_20 <- tmp$region_means_cv20
write.csv(NCRMP_PRICO_Occ_Den_CV, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_PRICO_Occ_Den_CV.csv", row.names = F)
write.csv(NCRMP_PRICO_Occ_Den_CV_20, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\CV\\NCRMP_PRICO_Occ_Den_CV_20.csv", row.names = F)
# copy to console and run
#usethis::use_data(NCRMP_PRICO_Occ_Den_CV,  overwrite = TRUE)
#usethis::use_data(NCRMP_PRICO_Occ_Den_CV_20,  overwrite = TRUE)
save(NCRMP_PRICO_Occ_Den_CV, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data//NCRMP_PRICO_Occ_Den_CV.rda")
save(NCRMP_PRICO_Occ_Den_CV_20, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_Occ_Den_CV_20.rda")
```
##### Species richness  
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "PRICO")
NCRMP_PRICO_2014_23_spp_list <- tmp$species_list 
NCRMP_PRICO_2014_23_richness_site <- tmp$richness_site
NCRMP_PRICO_2014_23_richness_strata <- tmp$richness_strata
NCRMP_PRICO_2014_23_richness_region <- tmp$Domain_est
NCRMP_PRICO_2014_23_diversity_site <- tmp$species_diversity_site
NCRMP_PRICO_2014_23_diversity_strata <- tmp$diversity_strata
NCRMP_PRICO_2014_23_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_PRICO_2014_23_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_richness_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_richness_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_richness_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_PRICO_2014_23_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_23_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_23_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_PRICO_2014_23_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_diversity_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_diversity_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_diversity_region.csv", row.names = F)
# copy to console and run
usethis::use_data(NCRMP_PRICO_2014_23_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_23_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_23_diversity_region,  overwrite = TRUE)
# remove old versions of data objects
```
##### Percent cover
###### Region
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_cover(region = "PRICO", project = "NCRMP")
NCRMP_PRICO_2014_23_percent_cover_species <- tmp$percent_cover_species
NCRMP_PRICO_2014_23_percent_cover_site <- tmp$percent_cover_site
NCRMP_PRICO_2014_23_cover_group_key <- tmp$cover_group_key
NCRMP_PRICO_2014_23_cover_strata <- tmp$cover_strata
NCRMP_PRICO_2014_23_cover_region <- tmp$Domain_est
NCRMP_PRICO_2014_23_Domain_check <- tmp$Domain_check # Make sure your cover groups add up to close to 100%
cover_check_site <- tmp$cover_check_site
# For the domain check, if this number if not very close to 100, there is likely something wrong with your ntot. Any strata that # was not sampled that year needs to be removed from the ntot BEFORE ngrot is calculated. Slight variations # from 100 could be due to using the most recent NTOT file for past years, this is ok.
# Export data 
write.csv(NCRMP_PRICO_2014_23_percent_cover_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_PRICO_2014_23_percent_cover_species.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_percent_cover_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_percent_cover_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_cover_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_cover_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_cover_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_cover_region.csv", row.names = F)
#usethis::use_data(NCRMP_PRICO_2014_21_percent_cover_species,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_percent_cover_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_percent_cover_species.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_percent_cover_site,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_percent_cover_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_percent_cover_site.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_cover_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_cover_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_cover_strata.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_cover_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_cover_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_cover_region.rda")
# remove old versions of objects
```
###### Species
```{r}
# Run function and assign names to dataframes 
tmp <-NCRMP_colony_percent_cover(region = "PRICO",
                                 ptitle = "Puerto Rico",
                                 file_path = "K:/_BioGeoProjects/NCRMP/Data Analysis/Analysis ready data/Figures" )
NCRMP_PRICO_2014_23_percent_cover_region_species <- tmp$region_means
# Export data 
write.csv(NCRMP_PRICO_2014_23_percent_cover_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_percent_cover_region_species.csv", row.names = F)
#usethis::use_data(NCRMP_PRICO_2014_21_percent_cover_region_species,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_percent_cover_region_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_percent_cover_region_species.rda")
```
###### Percent cover t-test 
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_PRICO_2014_23_cover_region,
                    metric1 = 'coral_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    n_years = 5,
                    test_type = "Years",
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_PRICO_2014_23_cover_region,
                    metric1 = 'macroalgae_cover',
                    metric2 = 'avCvr',
                    alpha = 0.05,
                    n_years = 5,
                    test_type = "Years",
                    return_dataframe = FALSE)
```
##### Mortality
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_mortality(project = "NCRMP",
                                     region = "PRICO",
                                     species_filter = "FALSE")
NCRMP_PRICO_2014_23_old_mort_site <- tmp$old_mortality_site
NCRMP_PRICO_2014_23_rec_mort_site <- tmp$recent_mortality_site
NCRMP_PRICO_2014_23_old_mort_strata <- tmp$old_mortality_strata
NCRMP_PRICO_2014_23_rec_mort_strata <- tmp$rec_mortality_strata
NCRMP_PRICO_2014_23_old_mort_region <- tmp$Domain_est_old_mort
NCRMP_PRICO_2014_23_rec_mort_region <- tmp$Domain_est_rec_mort
NCRMP_PRICO_2014_23_old_mort_species_region <- tmp$Domain_est_old_mort_species
NCRMP_PRICO_2014_23_rec_mort_species_region <- tmp$Domain_est_rec_mort_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_rec_mort_species$wh_sum)
unique(tmp$ntot_check_old_mort_species$wh_sum)
# Export data 
write.csv(NCRMP_PRICO_2014_23_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_old_mort_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_rec_mort_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_old_mort_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_rec_mort_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_old_mort_region.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_rec_mort_region.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_old_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_old_mort_species_region.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_rec_mort_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_rec_mort_species_region.csv", row.names = F)
# Sometimes you can run the usethis::use_data code in the console but not in the Rmd, not sure why it is so picky. Otherwise, just use save(). 
# usethis::use_data(NCRMP_PRICO_2014_21_rec_mort_site,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_rec_mort_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_rec_mort_site.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_old_mort_site,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_old_mort_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_old_mort_site.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_rec_mort_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_rec_mort_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_rec_mort_strata.rda")
# 
# usethis::use_data(NCRMP_PRICO_2014_21_old_mort_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_old_mort_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_old_mort_strata.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_rec_mort_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_rec_mort_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_rec_mort_region.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_old_mort_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_old_mort_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_old_mort_region.rda")
# usethis::use_data(NCRMP_PRICO_2014_23_old_mort_species_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_old_mort_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_old_mort_species_region.rda")
#usethis::use_data(NCRMP_PRICO_2014_23_rec_mort_species_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_rec_mort_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_rec_mort_species_region.rda")
```
###### Mortality t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_PRICO_2014_23_old_mort_region,
                    metric1 = "old_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 5,
                    test_type = "Years",
                    return_dataframe = FALSE)
NCRMP_perform_ttest(dataframe = NCRMP_PRICO_2014_23_rec_mort_region,
                    metric1 = "recent_mortality",
                    metric2 = 'avMort',
                    alpha = 0.05,
                    n_years = 5,
                    test_type = "Years",
                    return_dataframe = FALSE)
```
##### Disease and bleaching 
```{r}
tmp <- NCRMP_DRM_calculate_disease_prevalence_colonies(project = "NCRMP",
                                                       region = "PRICO",
                                                       species_filter = "FALSE")
NCRMP_PRICO_2014_23_dis_ble_prev_species <- tmp$dis_ble_prev_species
NCRMP_PRICO_2014_23_dis_ble_prev_site <- tmp$dis_ble_prev_site
NCRMP_PRICO_2014_23_dis_prev_strata <- tmp$dis_prev_strata
NCRMP_PRICO_2014_23_ble_prev_strata <- tmp$ble_prev_strata
NCRMP_PRICO_2014_23_dis_ble_prev_region <- tmp$Domain_est
# Export data
write.csv(NCRMP_PRICO_2014_23_dis_ble_prev_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_PRICO_2014_23_dis_ble_prev_species.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_dis_ble_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_dis_ble_prev_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_dis_prev_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_ble_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_ble_prev_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_dis_ble_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_dis_ble_prev_region.csv", row.names = F)
#usethis::use_data(NCRMP_PRICO_2014_21_dis_ble_prev_species,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_ble_prev_species, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_ble_prev_species.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_dis_ble_prev_site,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_ble_prev_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_ble_prev_site.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_dis_prev_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_prev_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_prev_strata.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_ble_prev_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_ble_prev_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_ble_prev_strata.rda")
 
# usethis::use_data(NCRMP_PRICO_2014_21_dis_ble_prev_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_ble_prev_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_ble_prev_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_dis_ble_prevalence_species_domain(project="NCRMP",
                                                             region = "PRICO")
NCRMP_PRICO_2014_23_dis_prev_species_region <- tmp$DomainEst_dis
NCRMP_PRICO_2014_23_ble_prev_species_region <- tmp$DomainEst_bl
# ntot check - wh_total should always be 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check$wh_total)
write.csv(NCRMP_PRICO_2014_23_dis_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_dis_prev_species_region.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_ble_prev_species_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_ble_prev_species_region.csv", row.names = F)
#usethis::use_data(NCRMP_PRICO_2014_21_dis_prev_species_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_prev_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_prev_species_region.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_ble_prev_species_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_ble_prev_species_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_ble_prev_species_region.rda")
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
tmp <- NCRMP_DRM_calculate_disease_prevalence_sites(project = "NCRMP",
                                                    region = "PRICO",
                                                    species_filter = "FALSE")
NCRMP_PRICO_2014_23_dis_ble_PA_site <- tmp$dis_ble_prev_site
NCRMP_PRICO_2014_23_dis_n_sites_per_strata <- tmp$dis_ble_prev_strata
NCRMP_PRICO_2014_23_dis_ble_n_sites_per_region <- tmp$disease_prev_region
write.csv(NCRMP_PRICO_2014_23_dis_ble_PA_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_dis_ble_PA_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_dis_n_sites_per_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_dis_n_sites_per_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_dis_ble_n_sites_per_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_dis_ble_n_sites_per_region.csv", row.names = F)
#usethis::use_data(NCRMP_PRICO_2014_21_dis_ble_PA_site,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_ble_PA_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_ble_PA_site.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_dis_n_sites_per_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_n_sites_per_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_n_sites_per_strata.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_dis_ble_n_sites_per_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_dis_ble_n_sites_per_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_dis_ble_n_sites_per_region.rda")
```
##### Colony size
```{r}
tmp <- NCRMP_DRM_calculate_mean_colony_size(project = "NCRMP",
                                            region = "PRICO",
                                            species_filter = "FALSE")
NCRMP_PRICO_2014_23_col_size_species <- tmp$size_species
NCRMP_PRICO_2014_23_col_size_site <- tmp$size_site
NCRMP_PRICO_2014_23_col_size_cm2_strata <- tmp$size_est_cm2_strata
NCRMP_PRICO_2014_23_col_size_cm3_strata <- tmp$size_est_cm3_strata
NCRMP_PRICO_2014_23_col_size_region <- tmp$Domain_est
NCRMP_PRICO_2014_23_col_size_region_species <- tmp$Domain_est_species
# check ntot weighting for species-specific mortality - should only be values of 1 (sum of weights across strata for each species in each year)
unique(tmp$ntot_check_species$wh_sum)
# Export data
write.csv(NCRMP_PRICO_2014_23_col_size_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\NCRMP_PRICO_2014_23_col_size_species.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_col_size_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_23_col_size_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_col_size_cm2_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_col_size_cm2_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_col_size_cm3_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_23_col_size_cm3_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_col_size_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_23_col_size_region.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_col_size_region_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_21_col_size_region_species.csv", row.names = F)
# copy to console and run
#usethis::use_data(NCRMP_PRICO_2014_21_col_size_species,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_col_size_species, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_col_size_species.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_col_size_site,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_col_size_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_col_size_site.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_col_size_cm2_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_col_size_cm2_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_col_size_cm2_strata.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_col_size_cm3_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_col_size_cm3_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_col_size_cm3_strata.rda")
#usethis::use_data(NCRMP_PRICO_2014_21_col_size_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_col_size_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_col_size_region.rda")
# usethis::use_data(NCRMP_PRICO_2014_23_col_size_region_species,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_col_size_region_species, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_col_size_region_species.rda")
```
###### Colony size t-test
```{r}
NCRMP_perform_ttest(dataframe = NCRMP_PRICO_2014_23_col_size_region,
                    metric1 = 'colony_size',
                    metric2 = 'avCm3',
                    alpha = 0.05,
                    n_years = 5,
                    test_type = "Years",
                    return_dataframe = FALSE)
```
##### Diadema density
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_calculate_invert_density(region = "PRICO")
NCRMP_PRICO_2014_23_invert_den_site <- tmp$diadema_density_site
NCRMP_PRICO_2014_23_invert_den_strata <- tmp$invert_strata # Right now just diadema
NCRMP_PRICO_2014_23_invert_den_region <- tmp$Domain_est
# Export data 
write.csv(NCRMP_PRICO_2014_23_invert_den_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_PRICO_2014_23_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_invert_den_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_PRICO_2014_23_invert_den_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_23_invert_den_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Invertebrates\\NCRMP_PRICO_2014_23_invert_den_region.csv", row.names = F)
# usethis::use_data(NCRMP_PRICO_2014_21_invert_den_site,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_invert_den_site, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_invert_den_site.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_invert_den_strata,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_invert_den_strata, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_invert_den_strata.rda")
# usethis::use_data(NCRMP_PRICO_2014_21_invert_den_region,  overwrite = TRUE)
save(NCRMP_PRICO_2014_23_invert_den_region, file = "~/Desktop/OneDrive - University of Miami/NOAA_NCRMP/ncrmp.benthics.analysis/data/NCRMP_PRICO_2014_23_invert_den_region.rda")
```
# ESA Corals P/A
```{r}
tmp <- NCRMP_calculate_ESA_corals_PresAbs()
NCRMP_AllRegions_Years_ESA_PresAbs_Strat <- tmp$NCRMP_AllRegions_Years_ESA_PresAbs_Strat
NCRMP_AllRegions_Years_ESA_PresAbs_Site <- tmp$NCRMP_AllRegions_Years_ESA_PresAbs_Site
region_year <- tmp$region_year # Check to make sure every region/year is accounted for 
write.csv(NCRMP_AllRegions_Years_ESA_PresAbs_Strat, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\ESA species\\NCRMP_AllRegions_Years_ESA_PresAbs_Strat.csv", row.names = F)
write.csv(NCRMP_AllRegions_Years_ESA_PresAbs_Site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\ESA species\\NCRMP_AllRegions_Years_ESA_PresAbs_Site.csv", row.names = F)
#usethis::use_data(NCRMP_AllRegions_Years_ESA_PresAbs_Strat,  overwrite = TRUE)
save(NCRMP_AllRegions_Years_ESA_PresAbs_Strat, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_AllRegions_Years_ESA_PresAbs_Strat.rda")
#usethis::use_data(NCRMP_AllRegions_Years_ESA_PresAbs_Site,  overwrite = TRUE)
save(NCRMP_AllRegions_Years_ESA_PresAbs_Site, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_AllRegions_Years_ESA_PresAbs_Site.rda")
```
# ESA FOI 
```{r}
tmp <- NCRMP_make_ESA_corals_FOI()
NCRMP_ESA_FOI_region <- tmp$FOI_region
NCRMP_ESA_FOI_species <- tmp$FOI_species
write.csv(NCRMP_ESA_FOI_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\ESA species\\NCRMP_ESA_FOI_region.csv", row.names = F)
write.csv(NCRMP_ESA_FOI_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\ESA species\\NCRMP_ESA_FOI_species.csv", row.names = F)
#usethis::use_data(NCRMP_ESA_FOI_region,  overwrite = TRUE)
#usethis::use_data(NCRMP_ESA_FOI_species,  overwrite = TRUE)
save(NCRMP_ESA_FOI_region, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_ESA_FOI_region.rda")
# 
save(NCRMP_ESA_FOI_species, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_ESA_FOI_species.rda")
```
# Bleaching abundance 
```{r}
# If updating with a new year, you need to run the below code chunk to update
# NCRMP_demo_All_regions_years first 
tmp <- NCRMP_make_bleaching_abundance()
NCRMP_bleaching_abundance_Allyears_Allregions <- tmp$NCRMP_bleaching_abundance_Allyears_Allregions
write.csv(NCRMP_bleaching_abundance_Allyears_Allregions, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Bleaching and Disease\\NCRMP_bleaching_abundance_Allyears_Allregions.csv", row.names = F)
save(NCRMP_bleaching_abundance_Allyears_Allregions, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_bleaching_abundance_Allyears_Allregions.rda")
```
# Combine regions
## Coral demographics
```{r}
tmp  <- dplyr::bind_rows(SEFCRI_2014_2stage_coral_demographics,
                         SEFCRI_2016_coral_demographics,
                         SEFCRI_2018_coral_demographics,
                         SEFCRI_2020_coral_demographics,
                         SEFCRI_2022_coral_demographics,
                         FLK_2014_coral_demographics,
                         FLK_2016_coral_demographics,
                         FLK_2018_coral_demographics %>% dplyr::mutate(RUGOSITY_CD = as.logical(RUGOSITY_CD)),
                         FLK_2020_coral_demographics,
                         FLK_2022_coral_demographics,
                         TortugasMarq_2014_coral_demographics,
                         TortugasMarq_2016_coral_demographics,
                         Tortugas_2018_coral_demographics,
                         Tortugas_2020_coral_demographics,
                         Tortugas_2022_coral_demographics,
                         USVI_2013_coral_demographics,
                         USVI_2015_coral_demographics,
                         USVI_2017_coral_demographics,
                         USVI_2019_coral_demographics,
                         USVI_2021_coral_demographics,
			                  USVI_2023_coral_demographics,
                         PRICO_2014_coral_demographics,
                         PRICO_2016_coral_demographics,
                         PRICO_2019_coral_demographics,
                         PRICO_2021_coral_demographics,
			                    PRICO_2023_coral_demographics) %>%
  # Combine and change to factor - there are letters in the FGBNMS MAPGRID NRs
  dplyr::mutate(MAPGRID_NR = as.factor(MAPGRID_NR))
NCRMP_demo_All_regions_years <- tmp %>%
  dplyr::bind_rows(
    FGBNMS_2013_coral_demographics %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2015_coral_demographics %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2018_coral_demographics %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2022_coral_demographics %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2024_coral_demographics %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR))
  )
write.csv(NCRMP_demo_All_regions_years, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Combined Regions and Years\\NCRMP_demo_All_regions_years.csv", row.names = F)
#write.csv(NCRMP_demo_All_regions_years, "C:\\Users\\Lexie.Sturm\\Documents\\NCRMP Files\\NCRMP_demo_All_regions_years.csv", row.names = F)
#usethis::use_data(NCRMP_demo_All_regions_years,  overwrite = TRUE)
save(NCRMP_demo_All_regions_years, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_demo_All_regions_years.rda")
```
## Benthic cover
```{r}
tmp  <- dplyr::bind_rows(SEFCRI_2014_2stage_benthic_cover,
                         SEFCRI_2016_benthic_cover,
                         SEFCRI_2018_benthic_cover,
                         SEFCRI_2020_benthic_cover,
                         SEFCRI_2022_benthic_cover,
                         FLK_2014_2stage_benthic_cover,
                         FLK_2016_benthic_cover,
                         FLK_2018_coral_demographics %>% dplyr::mutate(RUGOSITY_CD = as.logical(RUGOSITY_CD)),
                         FLK_2020_benthic_cover,
                         FLK_2022_benthic_cover,
                         TortugasMarq_2014_benthic_cover,
                         TortugasMarq_2016_benthic_cover,
                         Tortugas_2018_benthic_cover,
                         Tortugas_2020_benthic_cover,
                         Tortugas_2022_benthic_cover,
                         USVI_2013_benthic_cover,
                         USVI_2015_benthic_cover,
                         USVI_2017_benthic_cover,
                         USVI_2019_benthic_cover,
                         USVI_2021_benthic_cover,
			                   USVI_2023_benthic_cover,
                         PRICO_2014_benthic_cover,
                         PRICO_2016_benthic_cover,
                         PRICO_2019_benthic_cover,
                         PRICO_2021_benthic_cover,
                         PRICO_2023_benthic_cover) %>%
  # Combine and change to factor - there are letters in the FGBNMS MAPGRID NRs
  dplyr::mutate(MAPGRID_NR = as.factor(MAPGRID_NR))
NCRMP_benthic_cover_All_regions_years <- tmp %>%
  dplyr::bind_rows(
    FGBNMS_2013_benthic_cover %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2015_benthic_cover %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2018_benthic_cover %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2022_benthic_cover %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR)),
    FGBNMS_2024_benthic_cover %>% dplyr::mutate(MAPGRID_NR = as.character(MAPGRID_NR))
  )
write.csv(NCRMP_benthic_cover_All_regions_years, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Combined Regions and Years\\NCRMP_benthic_cover_All_regions_years.csv", row.names = F)
#write.csv(NCRMP_benthic_cover_All_regions_years, "C:\\Users\\Lexie.Sturm\\Documents\\NCRMP Files\\NCRMP_benthic_cover_All_regions_years.csv", row.names = F)
#usethis::use_data(NCRMP_benthic_cover_All_regions_years,  overwrite = TRUE)
save(NCRMP_benthic_cover_All_regions_years, file = "C:/Users/Lexie.Sturm/Documents/ncrmp/ncrmp.benthics.analysis/data/NCRMP_benthic_cover_All_regions_years.rda")
```
# DRM + SCREAM pre NCRMP metrics
##### Coral density - DRM + SCREAM
```{r}
# Run function and assign names to dataframes 
tmp <- DRM_SCREAM_calculate_colony_density(project = "DRM_SCREAM", 
                                           species_filter = "FALSE")
DRM_SCREAM_FL_1999_13_density_species <- tmp$density_species
DRM_SCREAM_FL_1999_13_density_site <- tmp$density_site
DRM_SCREAM_FL_1999_13_density_strata <- tmp$density_strata
DRM_SCREAM_FL_1999_13_density_region <- tmp$Domain_est
# Export data 
write.csv(DRM_SCREAM_FL_1999_13_density_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\DRM_SCREAM_FL_1999_13_density_species.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_density_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\DRM_SCREAM_FL_1999_13_density_site.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_density_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\DRM_SCREAM_FL_1999_13_density_strata.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_density_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\DRM_SCREAM_FL_1999_13_density_region.csv", row.names = F)
# usethis::use_data(DRM_SCREAM_FL_1999_13_density_species,  overwrite = TRUE)
save(DRM_SCREAM_FL_1999_13_density_species, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/DRM_SCREAM_FL_1999_13_density_species.rda")
# usethis::use_data(DRM_SCREAM_FL_1999_13_density_site,  overwrite = TRUE)
save(DRM_SCREAM_FL_1999_13_density_site, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/DRM_SCREAM_FL_1999_13_density_site.rda")
# usethis::use_data(DRM_SCREAM_FL_1999_13_density_strata,  overwrite = TRUE)
save(DRM_SCREAM_FL_1999_13_density_strata, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/DRM_SCREAM_FL_1999_13_density_strata.rda")
# usethis::use_data(DRM_SCREAM_FL_1999_13_density_region,  overwrite = TRUE)
save(DRM_SCREAM_FL_1999_13_density_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/DRM_SCREAM_FL_1999_13_density_region.rda")
```
##### Coral density - SCREAM
```{r}
# Run function and assign names to dataframes 
tmp <- DRM_SCREAM_calculate_colony_density(project = "SCREAM", 
                                           species_filter = "FALSE")
SCREAM_FL_1999_12_density_species <- tmp$density_species
SCREAM_FL_1999_12_density_site <- tmp$density_site
SCREAM_FL_1999_12_density_strata <- tmp$density_strata
SCREAM_FL_1999_12_density_region <- tmp$Domain_est
# Export data 
write.csv(SCREAM_FL_1999_12_density_species, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Species level metrics\\SCREAM_FL_1999_12_density_species.csv", row.names = F)
write.csv(SCREAM_FL_1999_12_density_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\SCREAM_FL_1999_12_density_site.csv", row.names = F)
write.csv(SCREAM_FL_1999_12_density_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\SCREAM_FL_1999_12_density_strata.csv", row.names = F)
write.csv(SCREAM_FL_1999_12_density_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\SCREAM_FL_1999_12_density_region.csv", row.names = F)
# usethis::use_data(SCREAM_FL_1999_12_density_species,  overwrite = TRUE)
save(SCREAM_FL_1999_12_density_species, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/SCREAM_FL_1999_12_density_species.rda")
# usethis::use_data(SCREAM_FL_1999_12_density_site,  overwrite = TRUE)
save(SCREAM_FL_1999_12_density_site, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/SCREAM_FL_1999_12_density_site.rda")
# usethis::use_data(SCREAM_FL_1999_12_density_strata,  overwrite = TRUE)
save(SCREAM_FL_1999_12_density_strata, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/SCREAM_FL_1999_12_density_strata.rda")
# usethis::use_data(SCREAM_FL_1999_12_density_region,  overwrite = TRUE)
save(SCREAM_FL_1999_12_density_region, file = "C:/Users/Sarah.Groves/Documents/R packages/NCRMP/ncrmp.benthics.analysis/data/SCREAM_FL_1999_12_density_region.rda")
```
##### Coral density - DRM
```{r}
# Run function and assign names to dataframes 
tmp <- DRM_SCREAM_calculate_colony_density(project = "DRM",
                                           species_filter = "FALSE")
DRM_FL_2005_13_density_site <- tmp$density_site
DRM_FL_2005_13_density_strata <- tmp$density_strata
DRM_FL_2005_13_density_region <- tmp$Domain_est
# Export data 
write.csv(DRM_FL_2005_13_density_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\DRM_FL_2005_13_density_site.csv", row.names = F)
write.csv(DRM_FL_2005_13_density_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_FL_2005_13_density_strata.csv", row.names = F)
write.csv(DRM_FL_2005_13_density_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_FL_2005_13_density_region.csv", row.names = F)
usethis::use_data(DRM_FL_2005_13_density_site,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_density_strata,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_density_region,  overwrite = TRUE)
```
##### Mortality - DRM + SCREAM 
```{r}
# Run function and assign names to dataframes 
tmp <- DRM_SCREAM_calculate_mortality(project = "DRM_SCREAM",
                                      species_filter = "FALSE")
DRM_SCREAM_FL_1999_13_old_mort_site <- tmp$old_mortality_site
DRM_SCREAM_FL_1999_13_rec_mort_site <- tmp$recent_mortality_site
DRM_SCREAM_FL_1999_13_old_mort_strata <- tmp$old_mortality_strata
DRM_SCREAM_FL_1999_13_rec_mort_strata <- tmp$rec_mortality_strata
DRM_SCREAM_FL_1999_13_old_mort_region <- tmp$Domain_est_old_mort
DRM_SCREAM_FL_1999_13_rec_mort_region <- tmp$Domain_est_rec_mort
# Export data 
write.csv(DRM_SCREAM_FL_1999_13_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\DRM_SCREAM_FL_1999_13_old_mort_site.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_PRICO_14_16_rec_mort_site.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_SCREAM_FL_1999_13_old_mort_strata.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_SCREAM_FL_1999_13_rec_mort_strata.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_SCREAM_FL_1999_13_old_mort_region.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_SCREAM_FL_1999_13_rec_mort_region.csv", row.names = F)
usethis::use_data(DRM_SCREAM_FL_1999_13_rec_mort_site,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_old_mort_site,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_old_mort_strata,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_rec_mort_region,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_old_mort_region,  overwrite = TRUE)
```
##### Mortality - DRM
```{r}
# Run function and assign names to dataframes 
tmp <- DRM_SCREAM_calculate_mortality(project = "DRM",
                                      species_filter = "FALSE")
DRM_FL_2005_13_old_mort_site <- tmp$old_mortality_site
DRM_FL_2005_13_rec_mort_site <- tmp$recent_mortality_site
DRM_FL_2005_13_old_mort_strata <- tmp$old_mortality_strata
DRM_FL_2005_13_rec_mort_strata <- tmp$rec_mortality_strata
DRM_FL_2005_13_old_mort_region <- tmp$Domain_est_old_mort
DRM_FL_2005_13_rec_mort_region <- tmp$Domain_est_rec_mort
# Export data 
write.csv(DRM_FL_2005_13_old_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\DRM_FL_2005_13_old_mort_site.csv", row.names = F)
write.csv(DRM_FL_2005_13_rec_mort_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_PRICO_14_16_rec_mort_site.csv", row.names = F)
write.csv(DRM_FL_2005_13_old_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_FL_2005_13_old_mort_strata.csv", row.names = F)
write.csv(DRM_FL_2005_13_rec_mort_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_FL_2005_13_rec_mort_strata.csv", row.names = F)
write.csv(DRM_FL_2005_13_old_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_FL_2005_13_old_mort_region.csv", row.names = F)
write.csv(DRM_FL_2005_13_rec_mort_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_FL_2005_13_rec_mort_region.csv", row.names = F)
usethis::use_data(DRM_FL_2005_13_rec_mort_site,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_old_mort_site,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_rec_mort_strata,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_old_mort_strata,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_rec_mort_region,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_old_mort_region,  overwrite = TRUE)
```
##### Disease prevalence - SCREAM + DRM 
```{r}
tmp <- DRM_SCREAM_calculate_disease_prevalence(project = "DRM_SCREAM",
                                               species_filter = "FALSE")
DRM_SCREAM_FL_1999_13_dis_prev_site <- tmp$disease_prev_site
DRM_SCREAM_FL_1999_13_dis_prev_strata <- tmp$dis_prev_strata 
DRM_SCREAM_FL_1999_13_dis_prev_region <- tmp$Domain_est
# Export data 
write.csv(DRM_SCREAM_FL_1999_13_dis_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\DRM_SCREAM_FL_1999_13_dis_prev_site.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_SCREAM_FL_1999_13_dis_prev_strata.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_dis_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_SCREAM_FL_1999_13_dis_prev_region.csv", row.names = F)
usethis::use_data(DRM_SCREAM_FL_1999_13_dis_prev_site,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_dis_prev_region,  overwrite = TRUE)
```
#####  DRM only Disease prevalence 
```{r}
tmp <- DRM_SCREAM_calculate_disease_prevalence(project = "DRM",
                                               species_filter = "FALSE")
DRM_FL_2005_13_dis_prev_site <- tmp$disease_prev_site
DRM_FL_2005_13_dis_prev_strata <- tmp$dis_prev_strata 
DRM_FL_2005_13_dis_prev_region <- tmp$Domain_est
# Export data 
write.csv(DRM_FL_2005_13_dis_prev_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\DRM_FL_2005_13_dis_prev_site.csv", row.names = F)
write.csv(DRM_FL_2005_13_dis_prev_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_FL_2005_13_dis_prev_strata.csv", row.names = F)
write.csv(DRM_FL_2005_13_dis_prev_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_FL_2005_13_dis_prev_region.csv", row.names = F)
usethis::use_data(DRM_FL_2005_13_dis_prev_site,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_dis_prev_strata,  overwrite = TRUE)
usethis::use_data(DRM_FL_2005_13_dis_prev_region,  overwrite = TRUE)
```
## Combine preNCRMP AR DRM and SCREAM data 
```{r SCREAM}
# Temporarily set the SCREAM file as the wd. It will revert back to the parent folder as soon
# as the chunk is done running.
setwd("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\SCREAM")
files <- list.files(pattern="*.csv")
SCREAM = do.call(rbind, lapply(files, function(x) read.csv(x, stringsAsFactors = FALSE)))
SCREAM <- SCREAM %>%
  mutate(SURVEY = "SCREAM",
         PRIMARY_SAMPLE_UNIT = as.factor(PRIMARY_SAMPLE_UNIT))
```
```{r DRM}
# Temporarily set the SCREAM file as the wd. It will revert back to the parent folder as soon
# as the chunk is done running.
setwd("K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\FL\\FRRP")
files <- list.files(pattern="*2stage_coral_demographics.csv")
DRM = do.call(rbind, lapply(files, function(x) read.csv(x, stringsAsFactors = FALSE)))
DRM <- DRM %>%
  mutate(SURVEY = "DRM",
         PRIMARY_SAMPLE_UNIT = as.factor(PRIMARY_SAMPLE_UNIT)) %>%
  filter(YEAR < 2014)
```
### Combine 
```{r DRM}
preNCRMP_SCREAM_DRM_coral_demographics <- as.data.frame(dplyr::bind_rows(SCREAM, DRM))
usethis::use_data(preNCRMP_SCREAM_DRM_coral_demographics, overwrite = TRUE)
```
# DEPRECATED OUTPUTS
##### Species richness - GOM
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_FRRP_calculate_species_richness_diversity(project = "NCRMP",
                                                       region = "GOM",
                                                       analysis_strat = "HABITAT_DEPTH")
NCRMP_FGBNMS_2013_18_spp_list <- tmp$species_list 
NCRMP_FGBNMS_2013_18_richness_site <- tmp$richness_site
NCRMP_FGBNMS_2013_18_richness_strata <- tmp$richness_strata
NCRMP_FGBNMS_2013_18_richness_region <- tmp$Domain_est
NCRMP_FGBNMS_2013_18_diversity_site <- tmp$species_diversity_site
NCRMP_FGBNMS_2013_18_diversity_strata <- tmp$diversity_strata
NCRMP_FGBNMS_2013_18_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_FGBNMS_2013_18_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_FGBNMS_2013_18_richness_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_18_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_FGBNMS_2013_18_richness_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_18_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_FGBNMS_2013_18_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_FGBNMS_2013_18_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_18_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_18_richness_region,  overwrite = TRUE)
# Diversity 
write.csv(NCRMP_FGBNMS_2013_18_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_FGBNMS_2013_18_diversity_site.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_18_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_FGBNMS_2013_18_diversity_strata.csv", row.names = F)
write.csv(NCRMP_FGBNMS_2013_18_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_FGBNMS_2013_18_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_FGBNMS_2013_18_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_18_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_FGBNMS_2013_18_diversity_region,  overwrite = TRUE)
```
##### Species richness - STX
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                      region = "STX")
NCRMP_STX_2015_21_spp_list <- tmp$species_list 
NCRMP_STX_2015_21_richness_site <- tmp$richness_site
NCRMP_STX_2015_21_richness_strata <- tmp$richness_strata
NCRMP_STX_2015_21_richness_region <- tmp$Domain_est
NCRMP_STX_2015_21_diversity_site <- tmp$species_diversity_site
NCRMP_STX_2015_21_diversity_strata <- tmp$diversity_strata
NCRMP_STX_2015_21_diversity_region <- tmp$Domain_est_div
# Export data 
write.csv(NCRMP_STX_2015_21_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_21_richness_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_21_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_21_richness_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_21_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_21_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_STX_2015_21_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_21_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_21_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_STX_2015_21_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STX_2015_21_diversity_site.csv", row.names = F)
write.csv(NCRMP_STX_2015_21_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STX_2015_21_diversity_strata.csv", row.names = F)
write.csv(NCRMP_STX_2015_21_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STX_2015_21_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_STX_2015_21_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_21_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STX_2015_21_diversity_region,  overwrite = TRUE)
```
##### Species richness - STTSTJ
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                      region = "STTSTJ")
NCRMP_STTSTJ_2013_19_spp_list <- tmp$species_list 
NCRMP_STTSTJ_2013_19_richness_site <- tmp$richness_site
NCRMP_STTSTJ_2013_19_richness_strata <- tmp$richness_strata
NCRMP_STTSTJ_2013_19_richness_region <- tmp$Domain_est
NCRMP_STTSTJ_2013_19_diversity_site <- tmp$species_diversity_site
NCRMP_STTSTJ_2013_19_diversity_strata <- tmp$diversity_strata
NCRMP_STTSTJ_2013_19_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_STTSTJ_2013_19_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_19_richness_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_19_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_19_richness_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_19_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_19_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_STTSTJ_2013_19_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_19_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_19_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_STTSTJ_2013_19_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_STTSTJ_2013_19_diversity_site.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_19_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_STTSTJ_2013_19_diversity_strata.csv", row.names = F)
write.csv(NCRMP_STTSTJ_2013_19_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_STTSTJ_2013_19_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_STTSTJ_2013_19_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_19_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_STTSTJ_2013_19_diversity_region,  overwrite = TRUE)
```
#### Species richness - PRICO
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                      region= "PRICO")
NCRMP_PRICO_2014_21_spp_list <- tmp$species_list 
NCRMP_PRICO_2014_21_richness_site <- tmp$richness_site
NCRMP_PRICO_2014_21_richness_strata <- tmp$richness_strata
NCRMP_PRICO_2014_19_richness_region <- tmp$Domain_est
NCRMP_PRICO_2014_19_diversity_site <- tmp$species_diversity_site
NCRMP_PRICO_2014_19_diversity_strata <- tmp$diversity_strata
NCRMP_PRICO_2014_19_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness 
write.csv(NCRMP_PRICO_2014_19_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_19_richness_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_19_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_19_richness_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_19_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_19_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_PRICO_2014_19_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_19_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_19_richness_region,  overwrite = TRUE) 
# Diversity
write.csv(NCRMP_PRICO_2014_19_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Site level metrics\\NCRMP_PRICO_2014_19_diversity_site.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_19_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Strata level metrics\\NCRMP_PRICO_2014_19_diversity_strata.csv", row.names = F)
write.csv(NCRMP_PRICO_2014_19_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\R Package Exports\\Domain estimates\\NCRMP_PRICO_2014_19_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_PRICO_2014_19_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_19_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_PRICO_2014_19_diversity_region,  overwrite = TRUE)
```
##### Species richness - SEFCRI - NCRMP only - DEPRECATED
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_FRRP_calculate_species_richness_diversity(project = "NCRMP",
                                                       region= "SEFCRI",
                                                       analysis_strat = "STRAT_PROT")
NCRMP_SEFCRI_2014_16_spp_list <- tmp$species_list 
NCRMP_SEFCRI_2014_16_richness_site <- tmp$richness_site
NCRMP_SEFCRI_2014_16_richness_strata <- tmp$richness_strata
NCRMP_SEFCRI_2014_16_richness_region <- tmp$Domain_est
NCRMP_SEFCRI_2014_16_diversity_site <- tmp$species_diversity_site
NCRMP_SEFCRI_2014_16_diversity_strata <- tmp$diversity_strata
NCRMP_SEFCRI_2014_16_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_SEFCRI_2014_16_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_SEFCRI_14_16_richness_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_16_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_SEFCRI_2014_16_richness_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_16_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_SEFCRI_2014_16_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_SEFCRI_2014_16_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_16_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_16_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_SEFCRI_2014_16_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_SEFCRI_2014_16_diversity_site.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_16_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_SEFCRI_2014_16_diversity_strata.csv", row.names = F)
write.csv(NCRMP_SEFCRI_2014_16_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_SEFCRI_2014_16_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_SEFCRI_2014_16_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_16_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_SEFCRI_2014_16_diversity_region,  overwrite = TRUE)
```
##### DRM Species richness - NCRMP + DRM - DEPRECATED
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_FRRP_calculate_species_richness_diversity(project = "NCRMP_FRRP",
                                                       region= "SEFCRI",
                                                       analysis_strat = "STRAT_PROT")
NCRMP_DRM_SEFCRI_2014_18_spp_list <- tmp$species_list 
NCRMP_DRM_SEFCRI_2014_18_richness_site <- tmp$richness_site
NCRMP_DRM_SEFCRI_2014_18_richness_strata <- tmp$richness_strata
NCRMP_DRM_SEFCRI_2014_18_richness_region <- tmp$Domain_est
NCRMP_DRM_SEFCRI_2014_18_diversity_site <- tmp$species_diversity_site
NCRMP_DRM_SEFCRI_2014_18_diversity_strata <- tmp$diversity_strata
NCRMP_DRM_SEFCRI_2014_18_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_DRM_SEFCRI_2014_18_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_18_richness_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_18_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_18_richness_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_18_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_18_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_18_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_18_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_18_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_DRM_SEFCRI_2014_18_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_DRM_SEFCRI_2014_18_diversity_site.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_18_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_DRM_SEFCRI_2014_18_diversity_strata.csv", row.names = F)
write.csv(NCRMP_DRM_SEFCRI_2014_18_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_DRM_SEFCRI_2014_18_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_18_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_18_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_SEFCRI_2014_18_diversity_region,  overwrite = TRUE)
```
##### Species richness - DRTO - NCRMP only
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP",
                                                      region= "Tortugas",
                                                      analysis_strat = "STRAT_PROT")
NCRMP_Tort_2014_18_spp_list <- tmp$species_list 
NCRMP_Tort_2014_18_richness_site <- tmp$richness_site
NCRMP_Tort_2014_18_richness_strata <- tmp$richness_strata
NCRMP_Tort_2014_18_richness_region <- tmp$Domain_est
NCRMP_Tort_2014_18_diversity_site <- tmp$species_diversity_site
NCRMP_Tort_2014_18_diversity_strata <- tmp$diversity_strata
NCRMP_Tort_2014_18_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_Tort_2014_18_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_Tort_2014_18_richness_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_18_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_Tort_2014_18_richness_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_18_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_Tort_2014_18_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_Tort_2014_18_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_18_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_18_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_Tort_2014_18_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_Tort_2014_18_diversity_site.csv", row.names = F)
write.csv(NCRMP_Tort_2014_18_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_Tort_2014_18_diversity_strata.csv", row.names = F)
write.csv(NCRMP_Tort_2014_18_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_Tort_2014_18_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_Tort_2014_18_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_18_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_Tort_2014_18_diversity_region,  overwrite = TRUE)
# Don't forget to delete the previous years output in the R package and in the Data Queries folder 
```
##### DRM Species richness - NCRMP + DRM 
```{r}
# Run function and assign names to dataframes 
tmp <- NCRMP_DRM_calculate_species_richness_diversity(project = "NCRMP_FRRP",
                                                      region = "Tortugas",
                                                      analysis_strat = "STRAT_PROT")
NCRMP_DRM_Tort_2014_18_spp_list <- tmp$species_list 
NCRMP_DRM_Tort_2014_18_richness_site <- tmp$richness_site
NCRMP_DRM_Tort_2014_18_richness_strata <- tmp$richness_strata
NCRMP_DRM_Tort_2014_18_richness_region <- tmp$Domain_est
NCRMP_DRM_Tort_2014_18_diversity_site <- tmp$species_diversity_site
NCRMP_DRM_Tort_2014_18_diversity_strata <- tmp$diversity_strata
NCRMP_DRM_Tort_2014_18_diversity_region <- tmp$Domain_est_div
# Export data 
# Richness
write.csv(NCRMP_DRM_Tort_2014_18_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_DRM_Tort_2014_18_richness_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_18_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_DRM_Tort_2014_18_richness_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_18_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_DRM_Tort_2014_18_richness_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_Tort_2014_18_richness_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_18_richness_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_18_richness_region,  overwrite = TRUE)
# Diversity
write.csv(NCRMP_DRM_Tort_2014_18_diversity_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\NCRMP_DRM_Tort_2014_18_diversity_site.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_18_diversity_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\NCRMP_DRM_Tort_2014_18_diversity_strata.csv", row.names = F)
write.csv(NCRMP_DRM_Tort_2014_18_diversity_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\NCRMP_DRM_Tort_2014_18_diversity_region.csv", row.names = F)
usethis::use_data(NCRMP_DRM_Tort_2014_18_diversity_site,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_18_diversity_strata,  overwrite = TRUE)
usethis::use_data(NCRMP_DRM_Tort_2014_18_diversity_region,  overwrite = TRUE)
```
##### Species Richness - SCREAM + DRM
```{r}
# Run function and assign names to dataframes 
tmp <- DRM_SCREAM_calculate_species_richness_diversity()
DRM_SCREAM_FL_1999_13_species_list <- tmp$
  DRM_SCREAM_FL_1999_13_richness_strata <- tmp$richness_site
DRM_SCREAM_FL_1999_13_richness_strata <- tmp$richness_strata
DRM_SCREAM_FL_1999_13_richness_strata <- tmp$Domain_est
# Export data 
write.csv(DRM_SCREAM_FL_1999_13_richness_site, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Site level metrics\\DRM_SCREAM_FL_1999_13_richness_site.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_richness_strata, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Strata level metrics\\DRM_SCREAM_FL_1999_13_richness_strata.csv", row.names = F)
write.csv(DRM_SCREAM_FL_1999_13_richness_region, "K:\\_BioGeoProjects\\NCRMP\\Data Analysis\\Analysis ready data\\Data Queries\\Domain estimates\\DRM_SCREAM_FL_1999_13_richness_region.csv", row.names = F)
usethis::use_data(DRM_SCREAM_FL_1999_13_richness_site,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_richness_strata,  overwrite = TRUE)
usethis::use_data(DRM_SCREAM_FL_1999_13_richness_region,  overwrite = TRUE)
```
